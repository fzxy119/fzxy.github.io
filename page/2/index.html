<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>别来无恙</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="别来无恙">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="别来无恙">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="晓">
<meta property="article:tag" content="java 软件工程 hexo 笔记 晓">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="别来无恙" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">别来无恙</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">晓</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about/me">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-linux/shellif" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/20/linux/shellif/" class="article-date">
  <time class="dt-published" datetime="2022-07-20T06:19:38.000Z" itemprop="datePublished">2022-07-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/20/linux/shellif/">shell if 条件判断</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Shell  语言中的if条件</p>
<h1 id="一、if的基本语法"><a href="#一、if的基本语法" class="headerlink" title="一、if的基本语法:"></a>一、if的基本语法:</h1><p>if [ command ];then</p>
<p>   符合该条件执行的语句</p>
<p>elif [ command ];then</p>
<p>   符合该条件执行的语句</p>
<p>else</p>
<p>   符合该条件执行的语句</p>
<p>fi</p>
<h1 id="二、文件-文件夹-目录-判断"><a href="#二、文件-文件夹-目录-判断" class="headerlink" title="二、文件/文件夹(目录)判断"></a>二、文件/文件夹(目录)判断</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">[ -b FILE ] 如果 FILE 存在且是一个块特殊文件则为真。</span><br><span class="line">[ -c FILE ] 如果 FILE 存在且是一个字特殊文件则为真。</span><br><span class="line">[ -d DIR ] 如果 FILE 存在且是一个目录则为真。</span><br><span class="line">[ -e FILE ] 如果 FILE 存在则为真。</span><br><span class="line">[ -f FILE ] 如果 FILE 存在且是一个普通文件则为真。</span><br><span class="line">[ -g FILE ] 如果 FILE 存在且已经设置了SGID则为真。</span><br><span class="line">[ -k FILE ] 如果 FILE 存在且已经设置了粘制位则为真。</span><br><span class="line">[ -p FILE ] 如果 FILE 存在且是一个名字管道(F如果O)则为真。</span><br><span class="line">[ -r FILE ] 如果 FILE 存在且是可读的则为真。</span><br><span class="line">[ -s FILE ] 如果 FILE 存在且大小不为0则为真。</span><br><span class="line">[ -t FD ] 如果文件描述符 FD 打开且指向一个终端则为真。</span><br><span class="line">[ -u FILE ] 如果 FILE 存在且设置了SUID (set user ID)则为真。</span><br><span class="line">[ -w FILE ] 如果 FILE存在且是可写的则为真。</span><br><span class="line">[ -x FILE ] 如果 FILE 存在且是可执行的则为真。</span><br><span class="line">[ -O FILE ] 如果 FILE 存在且属有效用户ID则为真。</span><br><span class="line">[ -G FILE ] 如果 FILE 存在且属有效用户组则为真。</span><br><span class="line">[ -L FILE ] 如果 FILE 存在且是一个符号连接则为真。</span><br><span class="line">[ -N FILE ] 如果 FILE 存在 and has been mod如果ied since it was last read则为真。</span><br><span class="line">[ -S FILE ] 如果 FILE 存在且是一个套接字则为真。</span><br><span class="line">[ FILE1 -nt FILE2 ] 如果 FILE1 has been changed more recently than FILE2, or 如果 FILE1 exists and FILE2 does not则为真。</span><br><span class="line">[ FILE1 -ot FILE2 ] 如果 FILE1 比 FILE2 要老, 或者 FILE2 存在且 FILE1 不存在则为真。</span><br><span class="line">[ FILE1 -ef FILE2 ] 如果 FILE1 和 FILE2 指向相同的设备和节点号则为真。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="三、字符串判断"><a href="#三、字符串判断" class="headerlink" title="三、字符串判断"></a>三、字符串判断</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ -z STRING ] 如果STRING的长度为零则为真 ，即判断是否为空，空即是真；</span><br><span class="line">[ -n STRING ] 如果STRING的长度非零则为真 ，即判断是否为非空，非空即是真；</span><br><span class="line">[ STRING1 = STRING2 ] 如果两个字符串相同则为真 ；</span><br><span class="line">[ STRING1 != STRING2 ] 如果字符串不相同则为真 ；</span><br><span class="line">[ STRING1 ]　 如果字符串不为空则为真,与-n类似</span><br></pre></td></tr></table></figure>
<h1 id="四、数值判断"><a href="#四、数值判断" class="headerlink" title="四、数值判断"></a>四、数值判断</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INT1 -eq INT2           INT1和INT2两数相等为真 ,=</span><br><span class="line">INT1 -ne INT2           INT1和INT2两数不等为真 ,&lt;&gt;</span><br><span class="line">INT1 -gt INT2            INT1大于INT1为真 ,&gt;</span><br><span class="line">INT1 -ge INT2           INT1大于等于INT2为真,&gt;=</span><br><span class="line">INT1 -lt INT2             INT1小于INT2为真 ,&lt;&lt;/div&gt;</span><br><span class="line">INT1 -le INT2             INT1小于等于INT2为真,&lt;=</span><br></pre></td></tr></table></figure>
<p>#五、复杂逻辑判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># -a 与 &amp;&amp;</span><br><span class="line"># -o 或 ||</span><br><span class="line"># !  非</span><br></pre></td></tr></table></figure>
<p>#六、举例</p>
<h2 id="6-1-if利用read传参判断"><a href="#6-1-if利用read传参判断" class="headerlink" title="6.1 if利用read传参判断"></a>6.1 if利用read传参判断</h2><p>exp2:查看分数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#echo -n &quot;please input your score:&quot;</span><br><span class="line">#read score</span><br><span class="line">#echo &quot;input score is $ score &quot;</span><br><span class="line">read -p &quot;please input a score:&quot; score</span><br><span class="line">echo -e &quot;your score [$score] is judging by sys now&quot;</span><br><span class="line">if [ &quot;$score&quot; -ge &quot;0&quot; ]&amp;&amp;[ &quot;$score&quot; -lt &quot;60&quot; ];then</span><br><span class="line">        echo &quot;sorry,you are lost!&quot;</span><br><span class="line">elif [ &quot;$score&quot; -ge &quot;60&quot; ]&amp;&amp;[ &quot;$score&quot; -lt &quot;85&quot; ];then</span><br><span class="line">        echo &quot;just soso!&quot;</span><br><span class="line">elif [ &quot;$score&quot; -le &quot;100&quot; ]&amp;&amp;[ &quot;$score&quot; -ge &quot;85&quot; ];then</span><br><span class="line">        echo &quot;good job!&quot;</span><br><span class="line">else</span><br><span class="line">        echo &quot;input score is wrong , the range is [0-100]!&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h2 id="shell-if-和-区别-amp-amp"><a href="#shell-if-和-区别-amp-amp" class="headerlink" title="shell if [[ ]]和[ ]区别 || &amp;&amp;"></a>shell if [[ ]]和[ ]区别 || &amp;&amp;</h2><h3 id="和test"><a href="#和test" class="headerlink" title="[]和test"></a>[]和test</h3><p>两者是一样的，在命令行里test expr和[ expr ]的效果相同。</p>
<p>test的三个基本作用是判断文件、判断字符串、判断整数。支持使用 ”与或非“ 将表达式连接起来。</p>
<p>test中可用的比较运算符只有==和!=，两者都是用于字符串比较的，不可用于整数比较，整数比较只能使用-eq, -gt这种形式。</p>
<p>无论是字符串比较还是整数比较都千万不要使用大于号小于号。当然，如果你实在想用也是可以的，对于字符串比较可以使用尖括号的转义形式， 如果比较”ab”和”bc”：[ ab &lt; bc ]，结果为真，也就是返回状态为0.</p>
<h3 id=""><a href="#" class="headerlink" title="[[ ]]"></a>[[ ]]</h3><p>这是内置在shell中的一个命令，它就比刚才说的test强大的多了。支持字符串的模式匹配（使用=~操作符时甚至支持shell的正则表达 式）。逻辑组合可以不使用test的-a,-o而使用&amp;&amp; ||。<br>字符串比较时可以把右边的作为一个模式（这是右边的字符串不加双引号的情况下。如果右边的字符串加了双引号，则认为是一个文本字符串。），而不仅仅是一个字符串，比如[[ hello == hell? ]]，结果为真。</p>
<p>注意：使用[]和[[]]的时候不要吝啬空格，每一项两边都要有空格，[[ 1 == 2 ]]的结果为“假”，但[[ 1==2 ]]的结果为“真”！<br>let和(())</p>
<p>两者也是一样的(或者说基本上是一样的，双括号比let稍弱一些)。主要进行算术运算(上面的两个都不行)，也比较适合进 行整数比较，可以直接使用熟悉的&lt;,&gt;等比较运算符。可以直接使用变量名如var而不需要$var这样的形式。支持分号隔开的多个表达式</p>
<hr>
<ol>
<li>首先，尽管很相似，但是从概念上讲，二者是不同层次的东西。</li>
</ol>
<p>“[[“，是关键字，许多shell(如ash bsh)并不支持这种方式。ksh, bash(据说从2.02起引入对[[的支持)等支持。</p>
<p>“[“是一条命令， 与test等价，大多数shell都支持。在现代的大多数sh实现中，”[“与”test”是内部(builtin)命令，换句话说执行”test”/“[“时不会调用/some/path/to/test这样的外部命令(如果有这样的命令的话)。</p>
<p>2.[[]]结构比Bash版本的[]更通用。在[[和]]之间的所有的字符都不会被文件扩展或是标记分割，但是会有参数引用和命令替换。</p>
<p>用[[ … ]]测试结构比用[ … ]更能防止脚本里的许多逻辑错误。比如说，&amp;&amp;,||,&lt;和&gt;操作符能在一个[[]]测试里通过，但在[]结构会发生错误。</p>
<p>3.(( ))结构扩展并计算一个算术表达式的值。如果表达式值为0，会返回1或假作为退出状态码。一个非零值的表达式返回一个0或真作为退出状态码。这个结构和先前test命令及[]结构的讨论刚好相反。</p>
<p>4.[ … ]为shell命令，所以在其中的表达式应是它的命令行参数，所以串比较操作符”&gt;” 与”&lt;”必须转义，否则就变成IO改向操作符了(请参看上面2中的例子)。在[[中”&lt;”与”&gt;”不需转义；<br>由于”[[“是关键字，不会做命令行扩展，因而相对的语法就稍严格些。例如</p>
<p>在[ … ]中可以用引号括起操作符，因为在做命令行扩展时会去掉这些引号，而在[[ … ]]则不允许这样做。</p>
<p>5.[[ … ]]进行算术扩展，而[ … ]不做</p>
<p>6.[[ … &amp;&amp; … &amp;&amp; …  ]] 和 [ … -a … -a …] 不一样，[[ ]] 是逻辑短路操作，而 [ ] 不会进行逻辑短路</p>
<p>1）在ksh中的test</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">数字的运算可使用let、(( )) ，其中运算时不需要变量$符号，运算符为 +、-、*、/、% ，不建议使用expr</span><br><span class="line">数字的比较使用 (( )) ，其运算符 &gt;、&gt;=、&lt;、&lt;=、==、!=</span><br><span class="line">可以使用算术扩展，如：(( 99+1 &lt;= 101 ))</span><br><span class="line">字符表达式的比较使用 [[ ]] ，其运算符 =、!=、-n、-z</span><br><span class="line">文件表达式的测试使用 [[ ]] ，其运算符 -r、-l、-w、-x、-f、-d、-s、-nt、-ot</span><br><span class="line">逻辑表达式的测试使用 [[ ]] ，其运算符 !、&amp;&amp;、||</span><br><span class="line">数字比较、字符比较、逻辑测试可以组合，如$ [[ &quot;a&quot; != &quot;b&quot; &amp;&amp; 4 -gt 3 ]]</span><br><span class="line">支持bash中的通配符扩展，如：[[ hest = h??t ]] 、[ hest = h*t ]]</span><br><span class="line">使用 (( )) 时，不需要空格分隔各值和运算符，使用 [[ ]] 时需要用空格分隔各值和运算符。</span><br><span class="line">2）bash与ksh中的 [[ ]] 不同</span><br><span class="line"></span><br><span class="line">在redhat9的bash中也可以使用 [[ ]] 符号。但是建议严格按照上面的原则使用。</span><br><span class="line">在bash中，数字的比较最好使用 (( ))，虽说可以使用 [[ ]]，但若在其内使用运算符 &gt;、&gt;=、&lt;、&lt;=、==、!= 时，其结果经常是错误的，不过若在 [[ ]] 中使用 [ ] 中的运算符“-eq、-ne、-le、-lt、-gt、-ge”等，还尚未发现有错。因此诸如$ [[ &quot; a&quot; != “b” &amp;&amp; 4 &gt; 3 ]] 这类组合（见上）也不可以在bash中使用，其出错率很高。</span><br><span class="line">例：[[ &quot;a&quot; != &quot;b&quot; &amp;&amp; 10 &gt; 2 ]] 判断结果就不正常。</span><br><span class="line">诸如 [ 2 \&lt; 10 ]、[[ 2 &lt; 10 ]] 都是不要使用。使用算术扩展最好用 (( 99+1 == 100 )) ，而不要使用[[ 99+1 -eq 100 ]] 。</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="运算符-描述-示例"><a href="#运算符-描述-示例" class="headerlink" title="运算符 描述 示例"></a>运算符 描述 示例</h2><p>文件比较运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-e filename	如果 filename 存在，则为真	[ -e /var/log/syslog ]</span><br><span class="line">-d filename	如果 filename 为目录，则为真	[ -d /tmp/mydir ]</span><br><span class="line">-f filename	如果 filename 为常规文件，则为真	[ -f /usr/bin/grep ]</span><br><span class="line">-L filename	如果 filename 为符号链接，则为真	[ -L /usr/bin/grep ]</span><br><span class="line">-r filename	如果 filename 可读，则为真	[ -r /var/log/syslog ]</span><br><span class="line">-w filename	如果 filename 可写，则为真	[ -w /var/mytmp.txt ]</span><br><span class="line">-x filename	如果 filename 可执行，则为真	[ -L /usr/bin/grep ]</span><br><span class="line">filename1 -nt filename2	如果 filename1 比 filename2 新，则为真	[ /tmp/install/etc/services -nt /etc/services ]</span><br><span class="line">filename1 -ot filename2	如果 filename1 比 filename2 旧，则为真	[ /boot/bzImage -ot arch/i386/boot/bzImage ]</span><br></pre></td></tr></table></figure>
<p>字符串比较运算符 （请注意引号的使用，这是防止空格扰乱代码的好方法）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-z string	如果 string 长度为零，则为真	[ -z &quot;$myvar&quot; ]</span><br><span class="line">-n string	如果 string 长度非零，则为真	[ -n &quot;$myvar&quot; ]</span><br><span class="line">string1 = string2	如果 string1 与 string2 相同，则为真	[ &quot;$myvar&quot; = &quot;one two three&quot; ]</span><br><span class="line">string1 != string2	如果 string1 与 string2 不同，则为真	[ &quot;$myvar&quot; != &quot;one two three&quot; ]</span><br></pre></td></tr></table></figure>
<p>算术比较运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num1 -eq num2	等于	[ 3 -eq $mynum ]</span><br><span class="line">num1 -ne num2	不等于	[ 3 -ne $mynum ]</span><br><span class="line">num1 -lt num2	小于	[ 3 -lt $mynum ]</span><br><span class="line">num1 -le num2	小于或等于	[ 3 -le $mynum ]</span><br><span class="line">num1 -gt num2	大于	[ 3 -gt $mynum ]</span><br><span class="line">num1 -ge num2	大于或等于	[ 3 -ge $mynum ]</span><br></pre></td></tr></table></figure>
<p>测试命令</p>
<h1 id="test命令用于检查某个条件是否成立，它可以进行数值、字符和文件3个方面的测试，其测试符和相应的功能分别如下。"><a href="#test命令用于检查某个条件是否成立，它可以进行数值、字符和文件3个方面的测试，其测试符和相应的功能分别如下。" class="headerlink" title="test命令用于检查某个条件是否成立，它可以进行数值、字符和文件3个方面的测试，其测试符和相应的功能分别如下。"></a>test命令用于检查某个条件是否成立，它可以进行数值、字符和文件3个方面的测试，其测试符和相应的功能分别如下。</h1><p>##（1）数值测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-eq 等于则为真。</span><br><span class="line"></span><br><span class="line">-ne 不等于则为真。</span><br><span class="line"></span><br><span class="line">-gt 大于则为真。</span><br><span class="line"></span><br><span class="line">-ge 大于等于则为真。</span><br><span class="line"></span><br><span class="line">-lt 小于则为真。</span><br><span class="line"></span><br><span class="line">-le 小于等于则为真。</span><br></pre></td></tr></table></figure>
<p>##（2）字串测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">= 等于则为真。</span><br><span class="line"></span><br><span class="line">!= 不相等则为真。</span><br><span class="line"></span><br><span class="line">-z字串 字串长度伪则为真。</span><br><span class="line"></span><br><span class="line">-n字串 字串长度不伪则为真。</span><br></pre></td></tr></table></figure>
<p>##（3）文件测试：</p>
<p>-e文件名 如果文件存在则为真。</p>
<p>-r文件名 如果文件存在且可读则为真。</p>
<p>-w文件名 如果文件存在且可写则为真。</p>
<p>-x文件名 如果文件存在且可执行则为真。</p>
<p>-s文件名 如果文件存在且至少有一个字符则为真。</p>
<p>-d文件名 如果文件存在且为目录则为真。</p>
<p>-f文件名 如果文件存在且为普通文件则为真。</p>
<p>-c文件名 如果文件存在且为字符型特殊文件则为真。</p>
<p>-b文件名 如果文件存在且为块特殊文件则为真</p>
<p>条件变量替换:<br>Bash Shell可以进行变量的条件替换,既只有某种条件发生时才进行替换,替换条件放在{}中.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(1) $&#123;value:-word&#125; </span><br><span class="line"></span><br><span class="line">当变量未定义或者值为空时,返回值为word的内容,否则返回变量的值. </span><br><span class="line"></span><br><span class="line">(2) $&#123;value:=word&#125; </span><br><span class="line"></span><br><span class="line">与前者类似,只是若变量未定义或者值为空时,在返回word的值的同时将word赋值给value </span><br><span class="line"></span><br><span class="line">(3) $&#123;value:?message&#125; </span><br><span class="line"></span><br><span class="line">若变量以赋值的话,正常替换.否则将消息message送到标准错误输出(若此替换出现在Shell程序中,那么该程序将终止运行) </span><br><span class="line"></span><br><span class="line">(4) $&#123;value:+word&#125; </span><br><span class="line">若变量以赋值的话,其值才用word替换,否则不进行任何替换 </span><br><span class="line"></span><br><span class="line">(5) $&#123;value:offset&#125; </span><br><span class="line">       $&#123;value:offset:length&#125;从变量中提取子串,这里offset和length可以是算术表达式. </span><br><span class="line"></span><br><span class="line">(6) $&#123;#value&#125; </span><br><span class="line"></span><br><span class="line">变量的字符个数 </span><br><span class="line"></span><br><span class="line">(7) $&#123;value#pattern&#125; 和 $&#123;value##pattern&#125; </span><br><span class="line">1. 去掉value中与pattern相匹配的部分,条件是value的开头与pattern相匹配</span><br><span class="line">2. ‘#’与‘##’的区别在于一个是最短匹配模式,一个是最长匹配模式. </span><br><span class="line"></span><br><span class="line">(8) $&#123;value%pattern&#125; 和 $&#123;value%%pattern&#125; </span><br><span class="line">于(7)类似,只是是从value的尾部于pattern相匹配,%与%%的区别与#与##一样 </span><br><span class="line"></span><br><span class="line">(9) $&#123;value/pattern/string&#125; 和 $&#123;value//pattern/string&#125; </span><br><span class="line">进行变量内容的替换,把与pattern匹配的部分替换为string的内容,/与//的区别与上同 </span><br><span class="line">注意: 上述条件变量替换中,除(2)外,其余均不影响变量本身的值 </span><br></pre></td></tr></table></figure>
<p>示例集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">var1=&quot;1&quot;</span><br><span class="line">var2=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">下面是并且的运算符-a，另外注意，用一个test命令就可以了，还有if条件后面的分号</span><br><span class="line"></span><br><span class="line">if test $var1 = &quot;1&quot;-a $var2 = &quot;2&quot; ; then</span><br><span class="line">   echo &quot;equal&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">下面是或运算符 -o，有一个为真就可以</span><br><span class="line"></span><br><span class="line">if test $var1 != &quot;1&quot; -o $var2 != &quot;3&quot; ; then</span><br><span class="line">   echo &quot;not equal&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">下面是非运算符 ！</span><br><span class="line">if条件是为真的时候执行，如果使用！运算符，那么原表达式必须为false</span><br><span class="line"></span><br><span class="line">if ! test $var1 != &quot;1&quot;; then</span><br><span class="line">   echo &quot;not 1&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>以上三个if都为真，所以三个echo都会打印</p>
<p>在一个文档把这几个运算法说的一塌糊涂，于是自己动手实验了一下</p>
<p>shell字符串比较、判断是否为数字</p>
<p>二元比较操作符,比较变量或者比较数字.注意数字与字符串的区别.</p>
<p>整数比较</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">-eq       等于,如:if [ &quot;$a&quot; -eq &quot;$b&quot; ]</span><br><span class="line">-ne       不等于,如:if [ &quot;$a&quot; -ne &quot;$b&quot; ]</span><br><span class="line">-gt       大于,如:if [ &quot;$a&quot; -gt &quot;$b&quot; ]</span><br><span class="line">-ge       大于等于,如:if [ &quot;$a&quot; -ge &quot;$b&quot; ]</span><br><span class="line">-lt       小于,如:if [ &quot;$a&quot; -lt &quot;$b&quot; ]</span><br><span class="line">-le       小于等于,如:if [ &quot;$a&quot; -le &quot;$b&quot; ]</span><br><span class="line">&lt;       小于(需要双括号),如:((&quot;$a&quot; &lt; &quot;$b&quot;))</span><br><span class="line">&lt;=       小于等于(需要双括号),如:((&quot;$a&quot; &lt;= &quot;$b&quot;))</span><br><span class="line">&gt;       大于(需要双括号),如:((&quot;$a&quot; &gt; &quot;$b&quot;))</span><br><span class="line">&gt;=       大于等于(需要双括号),如:((&quot;$a&quot; &gt;= &quot;$b&quot;))</span><br><span class="line">字符串比较</span><br><span class="line"></span><br><span class="line">=       等于,如:if [ &quot;$a&quot; = &quot;$b&quot; ]</span><br><span class="line">==       等于,如:if [ &quot;$a&quot; == &quot;$b&quot; ],与=等价</span><br><span class="line">       注意:==的功能在[[]]和[]中的行为是不同的,如下:</span><br><span class="line">       1 [[ $a == z* ]]    # 如果$a以&quot;z&quot;开头(模式匹配)那么将为true</span><br><span class="line">       2 [[ $a == &quot;z*&quot; ]] # 如果$a等于z*(字符匹配),那么结果为true</span><br><span class="line">       3</span><br><span class="line">       4 [ $a == z* ]      # File globbing 和word splitting将会发生</span><br><span class="line">       5 [ &quot;$a&quot; == &quot;z*&quot; ] # 如果$a等于z*(字符匹配),那么结果为true</span><br><span class="line">       一点解释,关于File globbing是一种关于文件的速记法,比如&quot;*.c&quot;就是,再如~也是.</span><br><span class="line">       但是file globbing并不是严格的正则表达式,虽然绝大多数情况下结构比较像.</span><br><span class="line">!=       不等于,如:if [ &quot;$a&quot; != &quot;$b&quot; ]</span><br><span class="line">       这个操作符将在[[]]结构中使用模式匹配.</span><br><span class="line">&lt;       小于,在ASCII字母顺序下.如:</span><br><span class="line">       if [[ &quot;$a&quot; &lt; &quot;$b&quot; ]]</span><br><span class="line">       if [ &quot;$a&quot; \&lt; &quot;$b&quot; ]</span><br><span class="line">       注意:在[]结构中&quot;&lt;&quot;需要被转义.</span><br><span class="line">&gt;       大于,在ASCII字母顺序下.如:</span><br><span class="line">       if [[ &quot;$a&quot; &gt; &quot;$b&quot; ]]</span><br><span class="line">       if [ &quot;$a&quot; \&gt; &quot;$b&quot; ]</span><br><span class="line">       注意:在[]结构中&quot;&gt;&quot;需要被转义.</span><br><span class="line">       具体参考Example 26-11来查看这个操作符应用的例子.</span><br><span class="line">-z       字符串为&quot;null&quot;.就是长度为0.</span><br><span class="line">-n       字符串不为&quot;null&quot;</span><br><span class="line">       注意:</span><br><span class="line">       使用-n在[]结构中测试必须要用&quot;&quot;把变量引起来.使用一个未被&quot;&quot;的字符串来使用! -z</span><br><span class="line">       或者就是未用&quot;&quot;引用的字符串本身,放到[]结构中。虽然一般情况下可</span><br><span class="line">       以工作,但这是不安全的.习惯于使用&quot;&quot;来测试字符串是一种好习惯.</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/20/linux/shellif/" data-id="clpfb6uhk001ttoqwa40qct5z" data-title="shell if 条件判断" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-java/jvm/javamissioncontol" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/19/java/jvm/javamissioncontol/" class="article-date">
  <time class="dt-published" datetime="2022-07-19T05:55:31.000Z" itemprop="datePublished">2022-07-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/19/java/jvm/javamissioncontol/">JMC(Java Mission Control)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JMC-客户端使用JMX-链接到JVM"><a href="#JMC-客户端使用JMX-链接到JVM" class="headerlink" title="JMC 客户端使用JMX 链接到JVM"></a>JMC 客户端使用JMX 链接到JVM</h1><p>一个是JMX端口（需要指定），JMX远程连接端口。<br>一个是RMI端口（默认随机），实际通信用的端口。<br>一个是本地服务端口（随机），用于本地jstat、jconsole连接用，本地使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS=&quot;-Dcom.sun.management.jmxremote=true</span><br><span class="line">-Djava.rmi.server.hostname=10.3.60.150</span><br><span class="line">-Dcom.sun.management.jmxremote.port=10000  </span><br><span class="line">-Dcom.sun.management.jmxremote.rmi.port=10001</span><br><span class="line">-Dcom.sun.management.jmxremote.ssl=false    </span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=true </span><br><span class="line">-Dcom.sun.management.jmxremote.password.file=/root/jmx/jmxremote.password</span><br><span class="line">-Dcom.sun.management.jmxremote.access.file=/root/jmx/jmxremote.access</span><br><span class="line">-XX:+UnlockCommercialFeatures</span><br><span class="line">-XX:+FlightRecorder</span><br><span class="line">-XX:StartFlightRecording=duration=60s,filename=150-cms-startFlight.jfr</span><br><span class="line">-XX:FlightRecorderOptions=defaultrecording=true,dumponexit=true,dumponexitpath=150-cms-onexit.jfr&quot;</span><br></pre></td></tr></table></figure>


<ul>
<li>控制密码文件有限传阅<br>chmode 600 password.file<br>chmode 600 access.file</li>
</ul>
<h1 id="JVM-使用命令行启动飞行器"><a href="#JVM-使用命令行启动飞行器" class="headerlink" title="JVM 使用命令行启动飞行器"></a>JVM 使用命令行启动飞行器</h1><p>解锁商业功能:UnlockCommercialFeatures  使JFR可用:FlightRecorder  短暂监控 StartFlightRecording 启动飞行器，持续时间60s 并保持到文件myrecording.jfr</p>
<p>-XX:+|-UnlockCommercialFeatures</p>
<p>-XX:+|-FlightRecorder</p>
<p>-XX:FlightRecorderOptions=defaultrecording=true,dumponexit=true,dumponexitpath=onexit.jfr,loglevel=trace</p>
<p>-XX:StartFlightRecording=duration=60s</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -XX:+UnlockCommercialFeatures -XX:+FlightRecorder -XX:StartFlightRecording=duration=60s,filename=startFlight.jfr  -XX:FlightRecorderOptions=defaultrecording=true,dumponexit=true,dumponexitpath=onexit.jfr,loglevel=trace MyApp</span><br></pre></td></tr></table></figure>

<p>在 JVM 启动参数中加入-XX:+StartFlightRecording=参数启动记录事件。参数为一个以逗号间隔的键值对数据。下面将介绍这些选项：</p>
<p>name=name<br>指定记录的名称</p>
<p>defaultrecording=true/false<br>是否在初始化时启动记录事件，默认为 false，对于反应分析，应设置为 true</p>
<p>settings=path<br>JFR 配置文件的路径</p>
<p>delay=time<br>开始记录前的延时</p>
<p>duration=time<br>记录持续时间</p>
<p>filename=path<br>保存记录事件的文件路径</p>
<p>compress=true/false<br>是否使用 gzip 压缩记录数据，默认为 false</p>
<p>maxage=time<br>环形缓存中保存记录的数据的最长时间</p>
<p>maxsize=size<br>环形缓存占用的最大空间</p>
<h1 id="使用动态命令"><a href="#使用动态命令" class="headerlink" title="使用动态命令"></a>使用动态命令</h1><p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javacomponents/jmc-5-4/jfr-runtime-guide/run.htm#JFRUH164">官方参考文档</a></p>
<h3 id="启动飞行器"><a href="#启动飞行器" class="headerlink" title="启动飞行器"></a>启动飞行器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jcmd process_id JFR.start [option_list]</span><br><span class="line"></span><br><span class="line">jcmd pid JFR.start duration=60s filename=myrecording.jfr</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查看pid jvm 可执行的命令</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jcmd  pid  help</span><br></pre></td></tr></table></figure>

<ol>
<li>JFR.start</li>
</ol>
<p>启动飞行器</p>
<ol start="2">
<li>JFR.check</li>
</ol>
<p>检查为指定进程运行的所有录制的状态，包括录制标识号、文件名、持续时间等</p>
<ol start="3">
<li>JFR.stop</li>
</ol>
<p>停止带有特定标识号的飞行器(默认情况下，停止飞行器1)。</p>
<ol start="4">
<li>JFR.dump</li>
</ol>
<p>转储到目前为止由具有特定标识号的记录收集的数据(默认情况下，转储来自记录1的数据)。</p>
<h2 id="Access-denied-Invalid-access-level-for-requested-MBeanServer-operation"><a href="#Access-denied-Invalid-access-level-for-requested-MBeanServer-operation" class="headerlink" title="Access denied! Invalid access level for requested MBeanServer operation."></a>Access denied! Invalid access level for requested MBeanServer operation.</h2><p>配置 JRE_HOME/lib/management/jmxremote.access  <em><strong>com.sun.management.</strong></em>*</p>
<p>monitorRole   readonly<br>controlRole   readwrite <br>              create javax.management.monitor.<em>,javax.management.timer.</em>,com.oracle.jrockit.<em>,com.sun.management.</em> <br>              unregister</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/19/java/jvm/javamissioncontol/" data-id="clpfb6uhx003ptoqw29l10yo7" data-title="JMC(Java Mission Control)" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-java/jvm/jprofiler" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/18/java/jvm/jprofiler/" class="article-date">
  <time class="dt-published" datetime="2022-07-18T08:56:20.000Z" itemprop="datePublished">2022-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/18/java/jvm/jprofiler/">Jprofiler</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1-核心组件"><a href="#1-核心组件" class="headerlink" title="1. 核心组件"></a>1. 核心组件</h1><p>JProfiler 包含用于采集目标 JVM 分析数据的 JProfiler agent、用于可视化分析数据的 JProfiler UI、提供各种功能的命令行工具.</p>
<p>它们之间的关系如下图所示:</p>
<img src="/2022/07/18/java/jvm/jprofiler/JPROFILER.png" class="" title="JPROFILER架构图">

<h3 id="JProfiler-agent"><a href="#JProfiler-agent" class="headerlink" title="JProfiler agent"></a>JProfiler agent</h3><p>JProfiler agent 是一个本地库，它可以在 JVM 启动时通过参数-agentpath:<path to native library>进行加载或者在程序运行时通过 JVM Attach 机制进行加载。Agent 被成功加载后，会设置 JVMTI 环境，监听虚拟机产生的事件，如类加载、线程创建等。例如，当它监听到类加载事件后，会给这些类注入用于执行度量操作的字节码。</p>
<h3 id="JProfiler-UI"><a href="#JProfiler-UI" class="headerlink" title="JProfiler UI"></a>JProfiler UI</h3><p>JProfiler UI 是一个可独立部署的组件，它通过 socket 和 agent 建立连接。这意味着不论目标 JVM 运行在本地还是远端，JProfiler UI 和 agent 间的通信机制都是一样的。</p>
<p>JProfiler UI 的主要功能是展示通过 agent 采集上来的分析数据，此外还可以通过它控制 agent 的采集行为，将快照保存至磁盘，展示保存的快照。</p>
<h3 id="命令行工具"><a href="#命令行工具" class="headerlink" title="命令行工具"></a>命令行工具</h3><p>JProfiler 提供了一系列命令行工具以实现不同的功能。</p>
<p>jpcontroller - 用于控制 agent 的采集行为。它通过 agent 注册的 JProfiler MBean 向 agent 传递命令。</p>
<p>jpenable - 用于将 agent 加载到一个正在运行的 JVM 上。</p>
<p>jpdump - 用于获取正在运行的 JVM 的堆快照。</p>
<p>jpexport &amp; jpcompare - 用于从保存的快照中提取数据并创建 HTML 报告。</p>
<p>要想对一个JVM进行分析，JProfiler的分析代理必须被加载到该JVM中。这可以通过两种不同的方式实现： 通过在启动脚本中指定一个-agentpath VM参数，或者通过Attach API将代理加载到已经运行的JVM中</p>
<p>两种模式JProfiler都支持。添加VM参数是分析的首选方式，集成向导、IDE插件和从JProfiler内启动JVM的会话配置都使用这种方式。 Attach既可在本地使用，也可通过SSH远程使用。</p>
<h1 id="2-JProfiler-设置"><a href="#2-JProfiler-设置" class="headerlink" title="2. JProfiler 设置"></a>2. JProfiler 设置</h1><h2 id="数据采集模式"><a href="#数据采集模式" class="headerlink" title="数据采集模式"></a>数据采集模式</h2><p>JProfier 提供两种数据采集模式 Sampling 和 Instrumentation。</p>
<ol>
<li><p>Sampling（采样） - 适合于不要求数据完全精确的场景。优点是对系统性能的影响较小，缺点是某些特性不支持（如方法级别的统计信息）</p>
</li>
<li><p>Instrumentation（仪表） - 完整功能模式，统计信息也是精确的。缺点是如果需要分析的类比较多，对应用性能影响较大。为了降低影响，往往需要和 Filter 一起使用</p>
</li>
</ol>
<h2 id="应用启动模式"><a href="#应用启动模式" class="headerlink" title="应用启动模式"></a>应用启动模式</h2><p>通过为 JProfiler agent 指定不同的参数可以控制应用的启动模式。</p>
<ol>
<li><p>等待模式 - 只有在 Jprofiler GUI 和 agent 建立连接并完成分析配置设置后，应用才会真正启动。在这种模式下，您能够获取应用启动时期的分析数据。对应的命令为-agentpath:<path to native library>=port=8849</p>
</li>
<li><p>立即启动模式 - 应用会立即启动，Jprofiler GUI 会在需要时和 agent 建立连接并设置分析配置。这种模式相对灵活，但会丢失应用启动初期的分析数据。对应的命令为-agentpath:<path to native library>=port=8849,nowait。</p>
</li>
</ol>
<h1 id="3-agentpath-VM参数-启动profiler-agent"><a href="#3-agentpath-VM参数-启动profiler-agent" class="headerlink" title="3. -agentpath VM参数 启动profiler agent"></a>3. -agentpath VM参数 启动profiler agent</h1><p>-agentpath是JVM提供的一个通用VM参数，用于加载任何一种使用JVMTI接口的本地库。 由于分析接口JVMTI是一个本地接口，所以分析代理必须是一个本地库。这意味着你只能在 明确支持的平台上进行分析。 32位和64位JVM也需要不同的本地库。另外，Java代理是用-javaagent VM参数加载的，并且只能访问有限的功能。</p>
<p>在-agentpath: 后面附加本地库的完整路径名。有一个等效参数-agentlib:， 你只需要指定特定平台的库名，但必须确保库路径中包含该库。在库的路径之后，你可以添加一个等号，并向代理传递选项，用逗号隔开。例如，在Linux上，整个参数看起来可能像这样：</p>
<blockquote>
<p>-agentpath:/opt/jprofiler10/bin/linux-x64/libjprofilerti.so=port=8849,nowait</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># jprofiler agent配置</span><br><span class="line">nohup java -agentpath:/usr/local/src/jprofiler12.0.4/bin/linux-x64/libjprofilerti.so=port=8849,nowait -jar -Xms256m -Xmx256m  ./$RESOURCE_NAME id.properties  &gt;/dev/null 2&gt;&amp;1  &amp;</span><br></pre></td></tr></table></figure>

<p>第一个等号将路径名与参数分开，第二个等号是参数port=8849 的一部分。 这个常用参数定义了分析代理监听来自JProfiler GUI连接的端口，实际上8849是默认端口，所以也可以省略这个参数。 如果你想在同一台机器上分析多个JVM，必须分配不同端口， 不过IDE插件和本地启动的会话会自动分配这个端口，对于集成向导，你必须显式选择端口。</p>
<p>第二个参数nowait告诉分析代理不要在启动时为了等待JProfiler GUI连接而阻塞JVM。 启动时的阻塞是默认的，因为分析代理不是以命令行参数的形式接收其分析设置，而是从JProfiler GUI或配置文件接收。 命令行参数仅用于引导分析代理，告诉它如何启动和传递调试标记。</p>
<p>默认情况下，JProfiler代理将通信Socket绑定到所有可用的网络接口。如果出于安全原因不希望这样做， 你可以添加选项address=[IP地址]以便选择指定接口，或loopback 只监听来自本地机器的请求。对于通过JProfiler UI启动的或通过IDE集成的JVM，会自动添加loopback</p>
<h1 id="4-jpenable-将-agent-加载到一个正在运行的-JVM-上"><a href="#4-jpenable-将-agent-加载到一个正在运行的-JVM-上" class="headerlink" title="4. jpenable 将 agent 加载到一个正在运行的 JVM 上"></a>4. jpenable 将 agent 加载到一个正在运行的 JVM 上</h1><ol>
<li><p>服务器运行 jpenable</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@localhost bin]# ./jpenable </span><br><span class="line">选择一个 JVM:</span><br><span class="line">org.apache.catalina.startup.Bootstrap start [6221] [1]</span><br><span class="line">org.apache.catalina.startup.Bootstrap start [9791] [2]</span><br><span class="line">org.elasticsearch.bootstrap.Elasticsearch -d [11417] [3]</span><br><span class="line">agentManageInternetCard-dubbo.jar [11778] [4]</span><br><span class="line">agentManageKafka-dubbo.jar [19613] [5]</span><br><span class="line">org.apache.catalina.startup.Bootstrap start [20276] [6]</span><br><span class="line">org.apache.catalina.startup.Bootstrap start [22974] [7]</span><br><span class="line">./agentManageJob.jar [24583] [8]</span><br><span class="line">./account-Job-1.0-SNAPSHOT.jar /us...project/job/id.properties [26293] [9]</span><br><span class="line">agentManageJobOrder-dubbo.jar [26438] [10]</span><br><span class="line">sun.tools.jstatd.Jstatd -p 10000 [27456] [11]</span><br><span class="line">agentManageAccount-dubbo.jar [27463] [12]</span><br><span class="line"></span><br><span class="line">8  # 选择添加agnet的进程</span><br><span class="line"></span><br><span class="line">请选择分析模式:</span><br><span class="line">GUI模式(与 JProfiler GUI Attach) [1, 回车(Enter)]</span><br><span class="line">离线模式(使用配置文件去设置分析设置) [2]</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">请输入分析端口</span><br><span class="line">[39923]</span><br><span class="line">1234</span><br><span class="line">你现在可以使用 JProfiler GUI 连接端口 1234</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>Jprofiler ui Attach 到远程agnet</p>
</li>
</ol>
<img src="/2022/07/18/java/jvm/jprofiler/jenable.png" class="" title="jenable">

<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/54274894">参考文档</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ej-technologies.com/resources/jprofiler/help_zh_CN/doc/main/architecture.html">官方帮助文档</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/18/java/jvm/jprofiler/" data-id="clpfb6uhy003utoqw9oj85ji0" data-title="Jprofiler" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-java/jvm/javatoll" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/18/java/jvm/javatoll/" class="article-date">
  <time class="dt-published" datetime="2022-07-18T01:46:01.000Z" itemprop="datePublished">2022-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/18/java/jvm/javatoll/">JAVA自带工具命令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JAVA-自带工具"><a href="#JAVA-自带工具" class="headerlink" title="JAVA 自带工具"></a>JAVA 自带工具</h1><ol>
<li>监控工具</li>
<li>故障排除工具</li>
<li>Java故障排除、分析、监控和管理工具</li>
<li>程方法调用(RMI)工具</li>
<li>国际化工具</li>
<li>基础工具</li>
<li>安全</li>
<li>脚本工具</li>
</ol>
<h2 id="一-监控工具"><a href="#一-监控工具" class="headerlink" title="一. 监控工具"></a>一. 监控工具</h2><ul>
<li><h3 id="jps"><a href="#jps" class="headerlink" title="jps"></a>jps</h3></li>
</ul>
<blockquote>
<p>JVM进程状态工具——列出目标系统上已检测的HotSpot Java虚拟机    jps [ options ] [ hostid ] </p>
</blockquote>
<blockquote>
<p>hostid -&gt; ([protocol:][[//]hostname][:port][/servername])  </p>
</blockquote>
<blockquote>
<p>protocol 默认为rmi</p>
</blockquote>
<blockquote>
<p>servername 此参数的处理取决于实现。对于优化的本地协议，该字段被忽略。对于rmi协议，该参数是一个字符串，表示远程主机上RMI远程对象的名称。请参见jstatd命令的-n选项</p>
</blockquote>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出传递给main方法的参数。对于嵌入式JVM，输出可能为空</span></span><br><span class="line">jps -m</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出传递给JVM的参数。</span></span><br><span class="line">jps -v</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务器上启动jstatd 链接远程服务器</span></span><br><span class="line">jps -v rmi://12.3.10.105:10000</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出应用程序主类的完整包名或应用程序JAR文件的完整路径名。</span></span><br><span class="line">jps -l</span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="jstat"><a href="#jstat" class="headerlink" title="jstat"></a>jstat</h3></li>
</ul>
<blockquote>
<p>jstat [ generalOption | outputOptions vmid [interval[s|ms] [count]] ]</p>
</blockquote>
<blockquote>
<p>vmid  =&gt;  [protocol:][//]lvmid[@hostname[:port]/servername]</p>
</blockquote>
<p>一些常用的工具</p>
<blockquote>
<p>jstat -gcnew -h 3 21891 250 #年轻代统计</p>
</blockquote>
<blockquote>
<p>jstat -gcutil 21891 250 7 #gc统计信息</p>
</blockquote>
<blockquote>
<p>jstat -gcutil <a href="mailto:&#x34;&#48;&#52;&#x39;&#54;&#64;&#x72;&#x65;&#109;&#x6f;&#116;&#101;&#46;&#100;&#111;&#x6d;&#97;&#x69;&#x6e;">&#x34;&#48;&#52;&#x39;&#54;&#64;&#x72;&#x65;&#109;&#x6f;&#116;&#101;&#46;&#100;&#111;&#x6d;&#97;&#x69;&#x6e;</a> 1000 #监控远程服务</p>
</blockquote>
<ol>
<li>generalOption（常规命令行选项 statOption）</li>
</ol>
<p> 一个常规命令行选项(-help或-options)  jstat -options<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-class</span><br><span class="line">-compiler</span><br><span class="line">-gc</span><br><span class="line">-gccapacity</span><br><span class="line">-gccause</span><br><span class="line">-gcnew</span><br><span class="line">-gcnewcapacity</span><br><span class="line">-gcold</span><br><span class="line">-gcoldcapacity</span><br><span class="line">-gcpermcapacity</span><br><span class="line">-gcutil</span><br><span class="line">-printcompilation</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>outputOptions （输出格式选项）<br>一个或多个输出选项，由单个statOption加上-t、-h和-J选项组成。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-h n</span><br><span class="line"></span><br><span class="line">每n个样本(输出行)显示一个列标题，其中n是正整数。默认值为0，表示在第一行数据上方显示列标题</span><br><span class="line"></span><br><span class="line">如：jstat -gcutil -h 2 24583 1000 10 （每两行输出一下标题）</span><br><span class="line"></span><br><span class="line">-t</span><br><span class="line"></span><br><span class="line">将时间戳列显示为输出的第一列。时间戳是自目标JVM启动以来的时间。</span><br><span class="line"></span><br><span class="line">-JjavaOption</span><br><span class="line">将javaOption传递给java应用程序启动器。例如，-J-Xms48m将启动内存设置为48兆字节。有关选项的完整列表，请参见Java-Java应用程序启动器</span><br><span class="line"></span><br></pre></td></tr></table></figure>
下表总结了jstat为每个statOption输出的列。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">-class Option  类加载统计</span><br><span class="line">Column	Description</span><br><span class="line">Loaded	Number of classes loaded.</span><br><span class="line">Bytes	Number of Kbytes loaded.</span><br><span class="line">Unloaded	Number of classes unloaded.</span><br><span class="line">Bytes	Number of Kbytes unloaded.</span><br><span class="line">Time	Time spent performing class load and unload operations.</span><br><span class="line"></span><br><span class="line">-compiler Option  HotSpot Just-In-Time Compiler Statistics JIT编译统计</span><br><span class="line">Column	Description</span><br><span class="line">Compiled	Number of compilation tasks performed.</span><br><span class="line">Failed	Number of compilation tasks that failed.</span><br><span class="line">Invalid	Number of compilation tasks that were invalidated.</span><br><span class="line">Time	Time spent performing compilation tasks.</span><br><span class="line">FailedType	Compile type of the last failed compilation.</span><br><span class="line">FailedMethod	Class name and method for the last failed compilation.</span><br><span class="line"></span><br><span class="line">-gc Option 垃圾收集的堆统计信息</span><br><span class="line">Column	Description</span><br><span class="line">S0C	Current survivor space 0 capacity (KB).</span><br><span class="line">S1C	Current survivor space 1 capacity (KB).</span><br><span class="line">S0U	Survivor space 0 utilization (KB).</span><br><span class="line">S1U	Survivor space 1 utilization (KB).</span><br><span class="line">EC	Current eden space capacity (KB).</span><br><span class="line">EU	Eden space utilization (KB).</span><br><span class="line">OC	Current old space capacity (KB).</span><br><span class="line">OU	Old space utilization (KB).</span><br><span class="line">PC	Current permanent space capacity (KB).</span><br><span class="line">PU	Permanent space utilization (KB).</span><br><span class="line">YGC	Number of young generation GC Events.</span><br><span class="line">YGCT	Young generation garbage collection time.</span><br><span class="line">FGC	Number of full GC events.</span><br><span class="line">FGCT	Full garbage collection time.</span><br><span class="line">GCT	Total garbage collection time.</span><br><span class="line"></span><br><span class="line">-gccapacity Option  各代内存池和空间容量</span><br><span class="line">Column	Description</span><br><span class="line">NGCMN	Minimum new generation capacity (KB).</span><br><span class="line">NGCMX	Maximum new generation capacity (KB).</span><br><span class="line">NGC	Current new generation capacity (KB).</span><br><span class="line">S0C	Current survivor space 0 capacity (KB).</span><br><span class="line">S1C	Current survivor space 1 capacity (KB).</span><br><span class="line">EC	Current eden space capacity (KB).</span><br><span class="line">OGCMN	Minimum old generation capacity (KB).</span><br><span class="line">OGCMX	Maximum old generation capacity (KB).</span><br><span class="line">OGC	Current old generation capacity (KB).</span><br><span class="line">OC	Current old space capacity (KB).</span><br><span class="line">PGCMN	Minimum permanent generation capacity (KB).</span><br><span class="line">PGCMX	Maximum Permanent generation capacity (KB).</span><br><span class="line">PGC	Current Permanent generation capacity (KB).</span><br><span class="line">PC	Current Permanent space capacity (KB).</span><br><span class="line">YGC	Number of Young generation GC Events.</span><br><span class="line">FGC	Number of Full GC Events.</span><br><span class="line"></span><br><span class="line">-gccause Option  该选项显示与-gcutil选项相同的垃圾收集统计信息摘要，但包括上次垃圾收集事件的原因和(如果适用)当前垃圾收集事件。除了为-gcutil列出的列之外，该选项还添加了以下列:</span><br><span class="line"></span><br><span class="line">Garbage Collection Statistics, Including GC Events</span><br><span class="line">Column	Description</span><br><span class="line">LGCC	Cause of last Garbage Collection.</span><br><span class="line">GCC	Cause of current Garbage Collection.</span><br><span class="line"></span><br><span class="line">-gcnew Option 年轻代统计信息</span><br><span class="line">Column	Description</span><br><span class="line">S0C	Current survivor space 0 capacity (KB).</span><br><span class="line">S1C	Current survivor space 1 capacity (KB).</span><br><span class="line">S0U	Survivor space 0 utilization (KB).</span><br><span class="line">S1U	Survivor space 1 utilization (KB).</span><br><span class="line">TT	Tenuring threshold.</span><br><span class="line">MTT	Maximum tenuring threshold.</span><br><span class="line">DSS	Desired survivor size (KB).</span><br><span class="line">EC	Current eden space capacity (KB).</span><br><span class="line">EU	Eden space utilization (KB).</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">YGCT	Young generation garbage collection time.</span><br><span class="line"></span><br><span class="line">-gcnewcapacity Option  年轻代空间统计</span><br><span class="line">Column	Description</span><br><span class="line">NGCMN</span><br><span class="line">Minimum new generation capacity (KB).</span><br><span class="line">NGCMX	Maximum new generation capacity (KB).</span><br><span class="line">NGC	Current new generation capacity (KB).</span><br><span class="line">S0CMX	Maximum survivor space 0 capacity (KB).</span><br><span class="line">S0C	Current survivor space 0 capacity (KB).</span><br><span class="line">S1CMX	Maximum survivor space 1 capacity (KB).</span><br><span class="line">S1C	Current survivor space 1 capacity (KB).</span><br><span class="line">ECMX	Maximum eden space capacity (KB).</span><br><span class="line">EC	Current eden space capacity (KB).</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">FGC	Number of Full GC Events.</span><br><span class="line"></span><br><span class="line">-gcold Option 来年代和永久代统计信息</span><br><span class="line">Column	Description</span><br><span class="line">PC	Current permanent space capacity (KB).</span><br><span class="line">PU	Permanent space utilization (KB).</span><br><span class="line">OC	Current old space capacity (KB).</span><br><span class="line">OU	old space utilization (KB).</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">FGC	Number of full GC events.</span><br><span class="line">FGCT	Full garbage collection time.</span><br><span class="line">GCT	Total garbage collection time.</span><br><span class="line"></span><br><span class="line">-gcoldcapacity Option 老年代统计</span><br><span class="line">Column	Description</span><br><span class="line">OGCMN	Minimum old generation capacity (KB).</span><br><span class="line">OGCMX	Maximum old generation capacity (KB).</span><br><span class="line">OGC	Current old generation capacity (KB).</span><br><span class="line">OC	Current old space capacity (KB).</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">FGC	Number of full GC events.</span><br><span class="line">FGCT	Full garbage collection time.</span><br><span class="line">GCT	Total garbage collection time.</span><br><span class="line"></span><br><span class="line">-gcpermcapacity Option 永久代统计</span><br><span class="line">Column	Description</span><br><span class="line">PGCMN	Minimum permanent generation capacity (KB).</span><br><span class="line">PGCMX	Maximum permanent generation capacity (KB).</span><br><span class="line">PGC	Current permanent generation capacity (KB).</span><br><span class="line">PC	Current permanent space capacity (KB).</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">FGC	Number of full GC events.</span><br><span class="line">FGCT	Full garbage collection time.</span><br><span class="line">GCT	Total garbage collection time.</span><br><span class="line"></span><br><span class="line">-gcutil Option 垃圾收集统计信息摘要</span><br><span class="line">Column	Description</span><br><span class="line">S0	Survivor space 0 utilization as a percentage of the space&#x27;s current capacity.</span><br><span class="line">S1	Survivor space 1 utilization as a percentage of the space&#x27;s current capacity.</span><br><span class="line">E	Eden space utilization as a percentage of the space&#x27;s current capacity.</span><br><span class="line">O	Old space utilization as a percentage of the space&#x27;s current capacity.</span><br><span class="line">P	Permanent space utilization as a percentage of the space&#x27;s current capacity.</span><br><span class="line">YGC	Number of young generation GC events.</span><br><span class="line">YGCT	Young generation garbage collection time.</span><br><span class="line">FGC	Number of full GC events.</span><br><span class="line">FGCT	Full garbage collection time.</span><br><span class="line">GCT	Total garbage collection time.</span><br><span class="line"></span><br><span class="line">-printcompilation Option HotSpot Compiler Method Statistics 方法统计</span><br><span class="line">Column	Description</span><br><span class="line">Compiled	Number of compilation tasks performed by the most recently compiled method.</span><br><span class="line">Size	Number of bytes of bytecode of the most recently compiled method.</span><br><span class="line">Type	Compilation type of the most recently compiled method.</span><br><span class="line">Method	Class name and method name identifying the most recently compiled method. Class name uses &quot;/&quot; instead of &quot;.&quot; as namespace separator. Method name is the method within the given class. The format for these two fields is consistent with the HotSpot - XX:+PrintComplation option.</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><h3 id="jstatd"><a href="#jstatd" class="headerlink" title="jstatd"></a>jstatd</h3></li>
</ul>
<p>JVM jstat Daemon——启动RMI服务器应用程序，该应用程序监视被检测的HotSpot Java虚拟机的创建和终止，并提供一个接口，允许远程监视工具连接到在本地系统上运行的Java虚拟机。</p>
<h2 id="二-故障排除工具"><a href="#二-故障排除工具" class="headerlink" title="二. 故障排除工具"></a>二. 故障排除工具</h2><ul>
<li><h3 id="jinfo"><a href="#jinfo" class="headerlink" title="jinfo"></a>jinfo</h3></li>
</ul>
<p>jinfo打印给定Java进程或核心文件或远程调试服务器的Java配置信息。配置信息包括Java系统属性和Java虚拟机命令行标志。</p>
<p>如果给定的进程在64位虚拟机上运行，您可能需要指定-J-d64选项，例如: jinfo -J-d64 -sysprops pid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# ./jinfo -flags 27463</span><br><span class="line">Attaching to process ID 27463, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.172-b11</span><br><span class="line">Non-default VM flags: -XX:CICompilerCount=3 -XX:InitialHeapSize=268435456 -XX:MaxHeapSize=536870912 -XX:MaxNewSize=178782208 -XX:MinHeapDeltaBytes=524288 -XX:NewSize=89128960 -XX:OldSize=179306496 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGC </span><br><span class="line">Command line:  -Xms256m -Xmx512m</span><br><span class="line"></span><br><span class="line">#查看某个flag</span><br><span class="line">[root@localhost bin]# ./jinfo -flag CICompilerCount 27463</span><br><span class="line">-XX:CICompilerCount=3</span><br><span class="line"></span><br><span class="line">#修改某个配置项值</span><br><span class="line">[root@localhost bin]# ./jinfo -flag CICompilerCount=4 27463</span><br><span class="line">#将配置项修改为false 禁用配置</span><br><span class="line">[root@localhost bin]# ./jinfo -flag -UseParallelGC 27463</span><br><span class="line">#将配置项修改为true 启用配置</span><br><span class="line">[root@localhost bin]# ./jinfo -flag +UseParallelGC 27463</span><br><span class="line"></span><br><span class="line">#查看jvm配置信息， 环境配置，系统配置 </span><br><span class="line">[root@localhost bin]# ./jinfo 27463</span><br><span class="line">Attaching to process ID 27463, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.172-b11</span><br><span class="line">Java System Properties:</span><br><span class="line"></span><br><span class="line">java.runtime.name = Java(TM) SE Runtime Environment</span><br><span class="line">java.vm.version = 25.172-b11</span><br><span class="line">sun.boot.library.path = /usr/local/src/jdk/jre/lib/amd64</span><br><span class="line">java.vendor.url = http://java.oracle.com/</span><br><span class="line">java.vm.vendor = Oracle Corporation</span><br><span class="line">path.separator = :</span><br><span class="line">file.encoding.pkg = sun.io</span><br><span class="line">java.vm.name = Java HotSpot(TM) 64-Bit Server VM</span><br><span class="line">sun.os.patch.level = unknown</span><br><span class="line">sun.java.launcher = SUN_STANDARD</span><br><span class="line">user.country = CN</span><br><span class="line">user.dir = /usr/local/agentManageAccount-dubbo/releases/20220406-170930</span><br><span class="line">java.vm.specification.name = Java Virtual Machine Specification</span><br><span class="line">java.runtime.version = 1.8.0_172-b11</span><br><span class="line">java.awt.graphicsenv = sun.awt.X11GraphicsEnvironment</span><br><span class="line">os.arch = amd64</span><br><span class="line">java.endorsed.dirs = /usr/local/src/jdk/jre/lib/endorsed</span><br><span class="line">java.io.tmpdir = /tmp</span><br><span class="line">line.separator = </span><br><span class="line"></span><br><span class="line">java.vm.specification.vendor = Oracle Corporation</span><br><span class="line">os.name = Linux</span><br><span class="line">sun.jnu.encoding = UTF-8</span><br><span class="line">java.library.path = /usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib</span><br><span class="line">java.specification.name = Java Platform API Specification</span><br><span class="line">java.class.version = 52.0</span><br><span class="line">sun.management.compiler = HotSpot 64-Bit Tiered Compilers</span><br><span class="line">os.version = 2.6.32-431.el6.x86_64</span><br><span class="line">user.home = /root</span><br><span class="line">user.timezone = PRC</span><br><span class="line">java.awt.printerjob = sun.print.PSPrinterJob</span><br><span class="line">file.encoding = UTF-8</span><br><span class="line">java.specification.version = 1.8</span><br><span class="line">user.name = root</span><br><span class="line">java.class.path = agentManageAccount-dubbo.jar</span><br><span class="line">java.vm.specification.version = 1.8</span><br><span class="line">sun.arch.data.model = 64</span><br><span class="line">sun.java.command = agentManageAccount-dubbo.jar</span><br><span class="line">java.home = /usr/local/src/jdk/jre</span><br><span class="line">user.language = zh</span><br><span class="line">java.specification.vendor = Oracle Corporation</span><br><span class="line">awt.toolkit = sun.awt.X11.XToolkit</span><br><span class="line">java.vm.info = mixed mode</span><br><span class="line">java.version = 1.8.0_172</span><br><span class="line">java.ext.dirs = /usr/local/src/jdk/jre/lib/ext:/usr/java/packages/lib/ext</span><br><span class="line">sun.boot.class.path = /usr/local/src/jdk/jre/lib/resources.jar:/usr/local/src/jdk/jre/lib/rt.jar:/usr/local/src/jdk/jre/lib/sunrsasign.jar:/usr/local/src/jdk/jre/lib/jsse.jar:/usr/local/src/jdk/jre/lib/jce.jar:/usr/local/src/jdk/jre/lib/charsets.jar:/usr/local/src/jdk/jre/lib/jfr.jar:/usr/local/src/jdk/jre/classes</span><br><span class="line">java.vendor = Oracle Corporation</span><br><span class="line">file.separator = /</span><br><span class="line">java.vendor.url.bug = http://bugreport.sun.com/bugreport/</span><br><span class="line">sun.io.unicode.encoding = UnicodeLittle</span><br><span class="line">sun.cpu.endian = little</span><br><span class="line">sun.cpu.isalist = </span><br><span class="line"></span><br><span class="line">VM Flags:</span><br><span class="line">Non-default VM flags: -XX:CICompilerCount=3 -XX:InitialHeapSize=268435456 -XX:MaxHeapSize=536870912 -XX:MaxNewSize=178782208 -XX:MinHeapDeltaBytes=524288 -XX:NewSize=89128960 -XX:OldSize=179306496 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGC </span><br><span class="line">Command line:  -Xms256m -Xmx512m</span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="jhat"><a href="#jhat" class="headerlink" title="jhat"></a>jhat</h3>堆转储浏览器-在堆转储文件(例如，由jmap -dump生成的文件)上启动web服务器，允许浏览堆。</li>
</ul>
<blockquote>
<p>使用 jhat file 查看。</p>
</blockquote>
<ul>
<li><h3 id="jmap"><a href="#jmap" class="headerlink" title="jmap"></a>jmap</h3><p>打印给定进程或核心文件或远程调试服务器的共享对象内存映射或堆内存细节。</p>
</li>
<li><h3 id="jsadebugd"><a href="#jsadebugd" class="headerlink" title="jsadebugd"></a>jsadebugd</h3></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jsadebugd pid [ server-id ]</span><br><span class="line">jsadebugd executable core [ server-id ]</span><br></pre></td></tr></table></figure>
<p>Java可服务性代理调试守护进程——附加到进程或核心文件，并充当调试服务器。</p>
<p>&nbsp;&nbsp;使用jinfo，jmap，jstack命令不仅可监控本地主机上的JVM进程，也可监控远端主机上的JVM进程，前者称为“本地模式”，后者称为“联网模式”。“联网模式”下的整个监控体系实质上是一个RMI应用程序。在“联网模式”下，一般情况下，远端主机上“运行rmiregistry服务，运行RMI Server”，本地主机上“运行RMI Client”，整个体系中“无需运行Web Server服务（因为所有相关类都可在本地获取）”。</p>
<p>&nbsp;&nbsp;如果rmiregistry没有启动，jsadebugd将在标准(1099)端口内部启动rmiregistry。可以通过向调试服务器发送SIGINT(按Ctrl-C)来停止调试服务器。</p>
<p>&nbsp;&nbsp;在远端主机上，通过运行jsadebugd命令开启RMI Server（需要注意的是，运行jsadebugd命令同时会自动运行rmiregistry服务，而无需手动运行），使用“PID”选项值指定远端主机上待被监控的JVM进程ID，使用“ServerId”选项值作为RMI Server内向rmiregistry服务注册所生成Remote Object实例的名称（如果未指定，则使用默认名称）；在本地主机上，运行jinfo，jmap，jstack命令作为RMI Client</p>
<blockquote>
<p>在远端主机上，执行jsadebugd -J-Djava.rmi.server.hostname=12.3.10.105 pid serviceID 命令开启RMI Server（同时开启rmiregistry服务），并使用“remoteObject1”名称向rmiregistry服务注册所生成的Remote Object实例</p>
</blockquote>
<blockquote>
<p>在本地主机上，执行jinfo/jmap/jstack <a href="mailto:&#115;&#x65;&#114;&#x76;&#x69;&#x63;&#101;&#x49;&#68;&#x40;&#x72;&#x65;&#109;&#x6f;&#x74;&#x65;&#x73;&#x65;&#114;&#118;&#101;&#114;&#46;&#104;&#111;&#x73;&#116;">&#115;&#x65;&#114;&#x76;&#x69;&#x63;&#101;&#x49;&#68;&#x40;&#x72;&#x65;&#109;&#x6f;&#x74;&#x65;&#x73;&#x65;&#114;&#118;&#101;&#114;&#46;&#104;&#111;&#x73;&#116;</a> 命令作为RMI Client与远端主机上的rmiregistry服务和RMI Server进行交互，而达到监控远端主机上相应JVM进程的目标。执行jinfo，jmap，jstack命令时可使用的选项参数可具体参考这些命令的“本地模式”用法</p>
</blockquote>
<ul>
<li><h3 id="jstack"><a href="#jstack" class="headerlink" title="jstack"></a>jstack</h3>打印给定进程或核心文件或远程调试服务器的线程堆栈跟踪。</li>
</ul>
<h2 id="三-Java故障排除、分析、监控和管理工具"><a href="#三-Java故障排除、分析、监控和管理工具" class="headerlink" title="三. Java故障排除、分析、监控和管理工具"></a>三. Java故障排除、分析、监控和管理工具</h2><ul>
<li>###jcmd</li>
</ul>
<p>JVM诊断命令工具——向正在运行的Java虚拟机发送诊断命令请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jcmd [ options ]</span><br><span class="line"></span><br><span class="line">jcmd [ pid | main-class ] PerfCounter.print</span><br><span class="line"></span><br><span class="line">jcmd [ pid | main-class ] command [ arguments ]</span><br><span class="line"></span><br><span class="line">jcmd [ pid | main-class ] -f file</span><br></pre></td></tr></table></figure>

<blockquote>
<p>./jcmd -l #打印正在运行的Java进程及其进程id、主类和命令行参数的列表。<br>./jcmd 1055 help #查看进程1055可执行的命令 ，获取结果如下:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1055:</span><br><span class="line">The following commands are available:</span><br><span class="line">JFR.stop</span><br><span class="line">JFR.start</span><br><span class="line">JFR.dump</span><br><span class="line">JFR.check</span><br><span class="line">VM.native_memory</span><br><span class="line">VM.check_commercial_features</span><br><span class="line">VM.unlock_commercial_features</span><br><span class="line">ManagementAgent.stop</span><br><span class="line">ManagementAgent.start_local</span><br><span class="line">ManagementAgent.start</span><br><span class="line">VM.classloader_stats</span><br><span class="line">GC.rotate_log</span><br><span class="line">Thread.print</span><br><span class="line">GC.class_stats</span><br><span class="line">GC.class_histogram</span><br><span class="line">GC.heap_dump</span><br><span class="line">GC.finalizer_info</span><br><span class="line">GC.heap_info</span><br><span class="line">GC.run_finalization</span><br><span class="line">GC.run</span><br><span class="line">VM.uptime</span><br><span class="line">VM.dynlibs</span><br><span class="line">VM.flags</span><br><span class="line">VM.system_properties</span><br><span class="line">VM.command_line</span><br><span class="line">VM.version</span><br><span class="line">help</span><br></pre></td></tr></table></figure>
<blockquote>
<p>./jcmd 1055 GC.run #对进程1055 pid 执行GC.run 命令</p>
</blockquote>
<ul>
<li>###jconsole</li>
</ul>
<p>一个符合JMX标准的图形化工具，用于监控Java虚拟机。它可以监控本地和远程JVM。它还可以监控和管理应用程序。 有关更多信息，请参见Java平台的监控和管理。</p>
<ul>
<li>###jmc</li>
</ul>
<p>Java Mission Control (JMC)客户端包括监控和管理Java应用程序的工具，而不会引入通常与这些类型的工具相关的性能开销。</p>
<ul>
<li>###jvisualvm</li>
</ul>
<p>一个图形工具，当基于Java技术的应用程序(Java应用程序)在Java虚拟机中运行时，它提供有关这些应用程序的详细信息。Java VisualVM提供内存和CPU分析、堆转储分析、内存泄漏检测、MBeans访问和垃圾收集。有关更多信息，请参见Java VisualVM。</p>
<h2 id="四-程方法调用-RMI-工具"><a href="#四-程方法调用-RMI-工具" class="headerlink" title="四. 程方法调用(RMI)工具"></a>四. 程方法调用(RMI)工具</h2><h2 id="五-国际化工具"><a href="#五-国际化工具" class="headerlink" title="五. 国际化工具"></a>五. 国际化工具</h2><ul>
<li>###native2ascii</li>
</ul>
<blockquote>
<p>JAVA_HOME\bin\native2ascii -encoding GBK D:\src\resources.properties D:\classes\resources.properties</p>
</blockquote>
<p>native2ascii [options] [inputfile [outputfile]]</p>
<p>options：</p>
<p>-reverse</p>
<p>执行相反的操作:将采用Unicode转义的ISO-8859-1编码的文件转换为Java运行时环境支持的任何字符编码的文件</p>
<p>-encoding encoding_name</p>
<p>指定转换过程要使用的字符编码的名称。如果该选项不存在，则使用默认的字符编码(由Java.nio.charset.charset.default charset方法确定)。encoding_name字符串必须是Java运行时环境支持的字符编码的名称，<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/7/docs/technotes/guides/intl/encoding.doc.html">请参见支持的编码文档。</a></p>
<p>-Joption</p>
<p>将option传递给java虚拟机，其中option是Java应用程序启动程序参考页上描述的选项之一。例如，-J-Xms48m将启动内存设置为48兆字节</p>
<h2 id="六-基础工具"><a href="#六-基础工具" class="headerlink" title="六. 基础工具"></a>六. 基础工具</h2><h2 id="七-安全"><a href="#七-安全" class="headerlink" title="七. 安全"></a>七. 安全</h2><h2 id="八-脚本工具"><a href="#八-脚本工具" class="headerlink" title="八. 脚本工具"></a>八. 脚本工具</h2><p>jrunscript是一个命令行脚本shell。jrunscript支持交互式(读取-评估-打印)模式和批处理(-f选项)模式的脚本执行。这是一个脚本语言独立的外壳。默认情况下，JavaScript是使用的语言，但是-l选项可以用于指定不同的语言。通过Java到脚本语言的通信，jrunscript支持“探索性编程”风格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jrunscript</span><br><span class="line">js&gt; print(&#x27;Hello World\n&#x27;);</span><br><span class="line">Hello World</span><br><span class="line">js&gt; 34 + 55</span><br><span class="line">89.0</span><br><span class="line">js&gt; t = new java.lang.Thread(function() &#123; print(&#x27;Hello World\n&#x27;); &#125;)</span><br><span class="line">Thread[Thread-0,5,main]</span><br><span class="line">js&gt; t.start()</span><br><span class="line">js&gt; Hello World</span><br><span class="line"></span><br><span class="line">js&gt;</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jrunscript.html">参考文档</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/18/java/jvm/javatoll/" data-id="clpfb6uhy003rtoqwe0q4abiz" data-title="JAVA自带工具命令" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-java/jvm/monitortool" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/14/java/jvm/monitortool/" class="article-date">
  <time class="dt-published" datetime="2022-07-14T13:00:46.000Z" itemprop="datePublished">2022-07-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/14/java/jvm/monitortool/">JVM监控工具</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JVM运行监控"><a href="#JVM运行监控" class="headerlink" title="JVM运行监控"></a>JVM运行监控</h1><ol>
<li>java自带工具命令</li>
<li>Eclipse Memory Analyzer</li>
<li>JMX Jstatd - Jconsole VisualVm</li>
<li>Btrace </li>
<li>火焰图</li>
<li>Flight Recorder  JavaMissionControl</li>
<li>JProfiler</li>
</ol>
<blockquote>
<p>监控整个集群的各项资源的使用情况以及各个服务的存活情况</p>
</blockquote>
<blockquote>
<p>监控代码问题导致的线程死锁，OOM</p>
</blockquote>
<h1 id="JMX-Jstatd-服务及Jconsole-VisualVm"><a href="#JMX-Jstatd-服务及Jconsole-VisualVm" class="headerlink" title="JMX Jstatd 服务及Jconsole VisualVm"></a>JMX Jstatd 服务及Jconsole VisualVm</h1><ol>
<li><p>JMX:使用JMX需要远程JVM在启动的时候开启远程访问支持，设定JMX端口等，每一个JMX连接一个远程JVM。</p>
</li>
<li><p>JStatD:使用jstatd连接方式时，需要在远程主机上创建安全策略文件然后启动jstatd进程，并且此进程需要一直保持运行状态,<strong>客户端可以看到远程主机上当前用户的所有JVM的信息</strong>，即只要创建一个jstatd连接</p>
</li>
</ol>
<h2 id="JMX方式"><a href="#JMX方式" class="headerlink" title="JMX方式"></a>JMX方式</h2><p>JMX，是Java Management Extensions(Java管理扩展)的缩写，是一个为应用程序植入管理功能的框架。用户可以在任何Java应用程序中使用这些代理和服务实现管理（Mbean）</p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.html#:~:text=Using%20File-Based%20Password%20Authentication%201%20Copy%20the%20password,and%20rename%20it%20to%20jmxremote.password.%20More%20items...%20">管方说明</a></p>
<img src="/2022/07/14/java/jvm/monitortool/jmxstracture.jpg" class="" title="JMX架构">

<h3 id="配置信息"><a href="#配置信息" class="headerlink" title="配置信息"></a>配置信息</h3><table>
<thead>
<tr>
<th align="left">配置</th>
<th align="left">功能</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-Dcom.sun.management.jmxremote=true</td>
<td align="left">相关 JMX 代理侦听开关</td>
<td align="left">true / false. Default is true.</td>
</tr>
<tr>
<td align="left">-Djava.rmi.server.hostname</td>
<td align="left">服务器端的IP</td>
<td align="left">服务ip</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.rmi.port=1000</td>
<td align="left">rmi端口</td>
<td align="left">默认随机</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.port=29094</td>
<td align="left">相关 JMX 代理侦听请求的端口</td>
<td align="left">Port number. No default.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.authenticate=false</td>
<td align="left">指定是否需要密码验证</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.password.file=JRE_HOME/lib/management/jmxremote.password</td>
<td align="left">密码认证文件，可自行指定，不指定在默认位置</td>
<td align="left">JRE_HOME/lib/management/ jmxremote.password</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.access.file=JRE_HOME/lib/management/jmxremote.access</td>
<td align="left">权限控制文件，可自行指定，不指定在默认位置</td>
<td align="left">JRE_HOME/lib/management/jmxremote.access</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.ssl</td>
<td align="left">指定是否使用 SSL 通讯</td>
<td align="left">true / false. Default is true.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.registry.ssl</td>
<td align="left">Binds the RMI connector stub to an RMI registry protected by SSL.</td>
<td align="left">true / false. Default is false.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.ssl.enabled.protocols</td>
<td align="left">A comma-delimited list of SSL/TLS protocol versions to enable. Used in conjunction with com.sun.management.jmxremote.ssl.</td>
<td align="left">Default SSL/TLS protocol version.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.ssl.enabled.cipher.suitese</td>
<td align="left">A comma-delimited list of SSL/TLS cipher suites to enable. Used in conjunction with com.sun.management.jmxremote.ssl.</td>
<td align="left">Default SSL/TLS cipher suites.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.ssl.need.client.auth</td>
<td align="left">If this property is true and the property com.sun.management.jmxremote.ssl is also true, then client authentication will be performed. It is recommended that you set this property to true.</td>
<td align="left">true / false. Default is false.</td>
</tr>
<tr>
<td align="left">-Dcom.sun.management.jmxremote.login.config</td>
<td align="left">Specifies the name of a Java Authentication and Authorization Service (JAAS) login configuration entry to use when the JMX agent authenticates users. When using this property to override the default login configuration, the named configuration entry must be in a file that is loaded by JAAS. In addition, the login modules specified in the configuration should use the name and password callbacks to acquire the user’s credentials. For more information, see the API documentation for javax.security.auth.callback.NameCallback and javax.security.auth.callback.PasswordCallback.</td>
<td align="left">Default login configuration is a file-based password authentication.</td>
</tr>
</tbody></table>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS=&quot;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">JAVA_OPTS</span> </span><br><span class="line">-Djava.rmi.server.hostname=127.0.0.1</span><br><span class="line">-Dcom.sun.management.jmxremote.port=10000       </span><br><span class="line">-Dcom.sun.management.jmxremote.ssl=false    # Disabling SSL</span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=true # Disabling Security</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>

<p>远程监控和管理需要安全性，以确保未经授权的人无法控制或监控您的应用程序。默认情况下，启用安全套接字层(SSL)和传输层安全性(TLS)上的密码身份验证。您可以分别禁用密码验证和SSL    </p>
<h3 id="密码认证"><a href="#密码认证" class="headerlink" title="密码认证"></a>密码认证</h3><p>JMX支持多种认证方式 使用LDAP认证，基于文件的密码认证，也可以禁用密码认证</p>
<h5 id="禁用密码及禁用ssl"><a href="#禁用密码及禁用ssl" class="headerlink" title="禁用密码及禁用ssl"></a>禁用密码及禁用ssl</h5><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-Dcom.sun.management.jmxremote.ssl=false    # Disabling SSL</span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=false # Disabling Security</span><br></pre></td></tr></table></figure>

<h5 id="基于文件的密码认证"><a href="#基于文件的密码认证" class="headerlink" title="基于文件的密码认证"></a>基于文件的密码认证</h5><p><strong>环境类型</strong></p>
<ol>
<li>单用户环境</li>
</ol>
<p>To Set up a Single-User Environment</p>
<p>You set up the password file in the JRE_HOME/lib/management directory as follows.</p>
<p>Copy the password template file, jmxremote.password.template, to jmxremote.password.</p>
<p>Set file permissions so that only the owner can read and write the password file.</p>
<p>Add passwords for roles such as monitorRole and controlRole.</p>
<ol start="2">
<li>多用户环境<br>To Set up a Multiple-User Environment</li>
</ol>
<p>You set up the password file in the JRE_HOME/lib/management directory as follows.</p>
<p>Copy the password template file, jmxremote.password.template, to your home directory and rename it to jmxremote.password.</p>
<p>Set file permissions so that only you can read and write the password file.</p>
<p>Add passwords for the roles such as monitorRole and controlRole.</p>
<p>Set the following system property when you start the Java VM.</p>
<p>com.sun.management.jmxremote.password.file=pwFilePath</p>
<p>In the above property, pwFilePath is the path to the password file.</p>
<p><strong>文件配置</strong><br>密码文件定义了不同的角色及其密码。访问控制文件(默认为jmxremote.access)定义了每个角色允许的访问权限。要发挥作用，角色必须在密码和访问文件中都有一个条目。</p>
<ol>
<li>密码文件 </li>
</ol>
<ul>
<li><p>模板文件位置 jdk/jre/lib/management/jmxremote.password.template</p>
</li>
<li><p>拷贝template文件到 JRE_HOME/lib/management/jmxremote.password 或者 你的用户目录, 为文件里的角色添加密码</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># specify actual password instead of the text password</span><br><span class="line">monitorRole password</span><br><span class="line">controlRole password</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 jmxremote.password</span><br></pre></td></tr></table></figure>

<p><em><strong>您必须确保只有所有者拥有该文件的读写权限，因为它包含明文形式的密码。出于安全原因，系统会检查文件是否只对所有者可读，如果不可读，则返回错误退出。因此，在多用户环境中，您应该将密码文件存储在私有位置，如您的主目录</strong></em></p>
<ol start="2">
<li>访问控制文件</li>
</ol>
<ul>
<li><p>访问文件定义了角色及其访问级别。默认情况下，access文件定义了以下两个主要角色。</p>
<p> monitorRole, 它授予监视的只读访问权限</p>
<p> controlRole, 它授予监视和管理的读写权限</p>
</li>
<li><p>访问控制条目由角色名称和关联的访问级别组成。角色名不能包含空格或制表符，并且必须对应于密码文件中的条目。访问级别可以是下列之一。</p>
<p> readonly,   它授予读取MBean属性的权限。对于监控，这意味着这个角色的远程客户端可以读取测量值，但是不能执行任何改变运行程序环境的操作。远程客户端也可以监听MBean通知    </p>
<p> readwrite, 它授予读取和写入MBean属性、调用对它们的操作以及创建或删除它们的权限。这种访问应该只授予受信任的客户端，因为它们可能会干扰应用程序的操作。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># The &quot;monitorRole&quot; role has readonly access.</span><br><span class="line"># The &quot;controlRole&quot; role has readwrite access.</span><br><span class="line">monitorRole readonly</span><br><span class="line">controlRole readwrite</span><br></pre></td></tr></table></figure>

<p><em><strong>默认情况下，access文件命名为jmxremote.access。属性名是来自与密码文件相同空间的标识。关联的值必须是readonly或readwrite。</strong></em></p>
<blockquote>
<p>注意:</p>
</blockquote>
<blockquote>
<p>可以在management.properties文件中指定 com.sun.management.jmxremote.* 属性，而不是在命令行中传递它们。<br>在这种情况下，需要系统属性-Dcom.sun.management.config.file=management.properties来指定management . properties文件的位置</p>
</blockquote>
<h2 id="Jstatd-方式"><a href="#Jstatd-方式" class="headerlink" title="Jstatd 方式"></a>Jstatd 方式</h2><p>jstatd工具是一个RMI服务器应用程序，它监视被检测的HotSpot Java虚拟机(JVM)的创建和终止，并提供一个接口，允许远程监视工具连接到在本地主机上运行的JVM</p>
<p>jstatd服务器要求本地主机上存在RMI注册表。jstatd服务器将尝试在默认端口或-p port选项指示的端口上连接到RMI注册表。如果没有找到RMI注册中心，将在jstatd应用程序中创建一个，绑定到-p port选项指定的端口，或者如果省略-p port，则绑定到默认的RMI注册中心端口。可以通过指定-nr选项来禁止创建内部RMI注册表。</p>
<blockquote>
<p>注册表其实不用写任何代码，在你的JAVA_HOME下bin目录下有一个rmiregistry程序，需要在你的程序的classpath下运行该程序</p>
</blockquote>
<h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><ul>
<li>-nr</li>
</ul>
<p>如果没有找到现有的RMI注册中心，不要试图在jstatd进程中创建内部RMI注册中心</p>
<ul>
<li>-p  port</li>
</ul>
<p>期望在其中找到RMI注册表的端口号，或者，如果没有找到，则在没有指定-nr的情况下创建。</p>
<ul>
<li>-n  rminame</li>
</ul>
<p>远程RMI对象在RMI注册表中绑定到的名称。默认名称为JStatRemoteHost。如果在同一台主机上启动了多个jstatd服务器，那么通过指定这个选项，可以使每个服务器的导出RMI对象的名称是唯一的。但是，这样做需要在监控客户端的hostid和vmid字符串中包含唯一的服务器名称</p>
<ul>
<li>-Joption</li>
</ul>
<p>将选项传递给javac调用的java启动器。例如，-J-Xms48m将启动内存设置为48兆字节。对于-J来说，将选项传递给执行用Java编写的应用程序的底层VM是一个常见的约定。</p>
<h3 id="安全配置"><a href="#安全配置" class="headerlink" title="安全配置"></a>安全配置</h3><p>jstatd服务器只能监视它拥有适当的本地访问权限的JVM。因此，jstatd进程必须使用与目标JVM相同的用户凭证运行。一些用户凭证，例如基于UNIX的系统中的root用户，有权访问系统上任何JVM导出的工具。使用这种凭证运行的jstatd进程可以监控系统上的任何JVM，但是会引入额外的安全问题。</p>
<p>jstatd服务器不提供任何远程客户端的身份验证。因此，运行jstatd服务器进程会向网络上的任何用户公开jstatd进程对其拥有访问权限的所有JVM的检测导出。这种暴露在您的环境中可能是不希望的，在启动jstatd进程之前应该考虑本地安全策略，尤其是在生产环境或不安全的网络中</p>
<p>如果没有安装其他安全管理器，jstatd服务器将安装RMISecurityPolicy的实例，因此需要指定安全策略文件。策略文件必须符合默认策略实现的策略文件语法</p>
<p>以下策略文件将允许jstatd服务器在没有任何安全异常的情况下运行。与授予所有代码库所有权限相比，此策略不够自由，但比授予运行jstatd服务器的最低权限的策略更自由。</p>
<ul>
<li><p>jstatd -J-Djava.security.policy=jstatd.all.policy</p>
</li>
<li><p>文件位置  jdk/bin/jstatd.all.policy</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grant codebase &quot;file:$&#123;java.home&#125;/../lib/tools.jar&quot; &#123;</span><br><span class="line">   permission java.security.AllPermission;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="服务启动"><a href="#服务启动" class="headerlink" title="服务启动"></a>服务启动</h3><ul>
<li>使用内部RMI注册表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jstatd -J-Djava.security.policy=all.policy</span><br></pre></td></tr></table></figure>

<ul>
<li>使用外部注册表</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">rmiregistry&amp;</span><br><span class="line">jstatd -J-Djava.security.policy=all.policy</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个例子演示了在端口2020上用外部RMI注册服务器启动jstatd。</span></span><br><span class="line">rmiregistry 2020&amp;</span><br><span class="line">jstatd -J-Djava.security.policy=all.policy -p 2020</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个例子演示了在端口2020上用一个外部RMI注册表启动jstatd，绑定到名为AlternateJstatdServerName。</span></span><br><span class="line">rmiregistry 2020&amp;</span><br><span class="line">jstatd -J-Djava.security.policy=all.policy -p 2020 -n AlternateJstatdServerName</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个例子演示了如何启动jstatd，如果没有找到RMI注册表，它就不会创建RMI注册表。这个例子假设RMI注册表已经在运行。如果不是，则会发出适当的错误消息。</span></span><br><span class="line">jstatd -J-Djava.security.policy=all.policy -nr</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这个例子演示了在启用RMI日志功能的情况下启动jstatd。这项技术有助于故障排除或监控服务器活动</span></span><br><span class="line">jstatd -J-Djava.security.policy=all.policy -J-Djava.rmi.server.logCalls=true</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/14/java/jvm/monitortool/" data-id="clpfb6uhz003xtoqwgo1z7f5w" data-title="JVM监控工具" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-linux/limit" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/14/linux/limit/" class="article-date">
  <time class="dt-published" datetime="2022-07-14T03:47:51.000Z" itemprop="datePublished">2022-07-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/14/linux/limit/">Linux limit</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Linux-limit-系统资源限制相关配置信息及其含义介绍"><a href="#Linux-limit-系统资源限制相关配置信息及其含义介绍" class="headerlink" title="Linux limit 系统资源限制相关配置信息及其含义介绍"></a>Linux limit 系统资源限制相关配置信息及其含义介绍</h1><h2 id="资源限制范围"><a href="#资源限制范围" class="headerlink" title="资源限制范围"></a>资源限制范围</h2><p>资源限制分为系统级别和用户界别</p>
<ol>
<li><p>/etc/sysctl.conf 文件用于设置系统范围的资源限制</p>
</li>
<li><p>/etc/security/limits.conf 为 Oracle、MariaDB 和 Apache 等特定用户设置资源限制</p>
</li>
</ol>
<h2 id="sysctl-介绍"><a href="#sysctl-介绍" class="headerlink" title="sysctl 介绍"></a>sysctl 介绍</h2><p>sysctl 用来设置系统的核心参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-a 显示当前所有设置</span><br><span class="line">-A 以表格的形式显示</span><br><span class="line">-e 模糊模式</span><br><span class="line">-n 忽略关键词</span><br><span class="line">-w 设置变量值</span><br><span class="line">-p&lt;文件&gt; 指定配置文件</span><br><span class="line">-h 显示帮助信息</span><br><span class="line">-V 版本信息  </span><br></pre></td></tr></table></figure>

<p><em>sysctl -a   #显示系统核心设置</em></p>
<p><em>sysctl -w net.ipv4.tcp_max_syn_backlog=256 #设置环境变量</em></p>
<p><em>sysctl -p   #立马生效</em></p>
<h2 id="1-系统级别限制配置"><a href="#1-系统级别限制配置" class="headerlink" title="1. 系统级别限制配置"></a>1. 系统级别限制配置</h2><ul>
<li> 下次重启之前有效 修改系统级限制配置</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w fs.file-max=100000</span><br></pre></td></tr></table></figure>

<ul>
<li>无需注销和重新启动配置 修改系统级别限制配置</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysctl.conf</span><br><span class="line"></span><br><span class="line">fs.file-max = 100000                       #最大打开文件数</span><br><span class="line">fs.file-nr = 2080       0       1621092    #文件描述符数量</span><br><span class="line"></span><br><span class="line">sysctl -p #使上述更改立即生效</span><br><span class="line"></span><br><span class="line">cat /proc/sys/fs/file-max #验证新的更改是否生效</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">或者</span></span><br><span class="line">sysctl -a|grep file</span><br></pre></td></tr></table></figure>
<ul>
<li>查看系统相关配置<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/sys/fs/file-nr #系统打开文件数描述符限制</span><br><span class="line"></span><br><span class="line">cat /proc/sys/fs/file-max #系统打开文件数限制</span><br><span class="line"></span><br><span class="line">sysctl -a|grep file</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-用户及系统限制"><a href="#2-用户及系统限制" class="headerlink" title="2. 用户及系统限制"></a>2. 用户及系统限制</h2><ul>
<li>ulimit指令 控制shell程序的资源</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> -a 　显示目前资源限制的设定。 </span><br><span class="line">  -c  　设定core文件的最大值，单位为区块。 </span><br><span class="line">  -d &lt;数据节区大小&gt; 　程序数据节区的最大值，单位为KB。 </span><br><span class="line">  -f &lt;文件大小&gt; 　shell所能建立的最大文件，单位为区块。 </span><br><span class="line">  -H 　设定资源的硬性限制，也就是管理员所设下的限制。 </span><br><span class="line">  -m &lt;内存大小&gt; 　指定可使用内存的上限，单位为KB。 </span><br><span class="line">  -n &lt;文件数目&gt; 　指定同一时间最多可开启的文件数。 </span><br><span class="line">  -p &lt;缓冲区大小&gt; 　指定管道缓冲区的大小，单位512字节。 </span><br><span class="line">  -s &lt;堆叠大小&gt; 　指定线程栈大小的上限，单位为KB。 </span><br><span class="line"></span><br><span class="line">  -S 　设定资源的弹性限制。 </span><br><span class="line"></span><br><span class="line">  -t  　指定CPU使用时间的上限，单位为秒。 </span><br><span class="line">  -u &lt;程序数目&gt; 　用户最多可开启的程序数目。 </span><br><span class="line">  -v &lt;虚拟内存大小&gt; 　指定可使用的虚拟内存上限，单位为KB。</span><br><span class="line"></span><br><span class="line">ulimit -n –&gt; 显示打开文件数限制</span><br><span class="line">ulimit -c –&gt; 显示核心转储文件大小</span><br><span class="line">umilit -u –&gt; 显示登录用户的最大用户进程数限制</span><br><span class="line">ulimit -f –&gt; 显示用户可以拥有的最大文件大小</span><br><span class="line">umilit -m –&gt; 显示登录用户的最大内存大小</span><br><span class="line">ulimit -v –&gt; 显示最大内存大小限制</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ulimit -a                    #显示系统资源的设置</span><br><span class="line"></span><br><span class="line">core file size          (blocks, -c) 0</span><br><span class="line">data seg size           (kbytes, -d) unlimited</span><br><span class="line">scheduling priority             (-e) 0</span><br><span class="line">file size               (blocks, -f) unlimited</span><br><span class="line">pending signals                 (-i) 3846</span><br><span class="line">max locked memory       (kbytes, -l) 64</span><br><span class="line">max memory size         (kbytes, -m) unlimited</span><br><span class="line">open files                      (-n) 1024</span><br><span class="line">pipe size            (512 bytes, -p) 8</span><br><span class="line">POSIX message queues     (bytes, -q) 819200</span><br><span class="line">real-time priority              (-r) 0</span><br><span class="line">stack size              (kbytes, -s) 8192</span><br><span class="line">cpu time               (seconds, -t) unlimited</span><br><span class="line">max user processes              (-u) 3846</span><br><span class="line">virtual memory          (kbytes, -v) unlimited</span><br><span class="line">file locks                      (-x) unlimited</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ulimit -u 65525				 #设置单一用户程序数目上限</span><br><span class="line"></span><br><span class="line">core file size          (blocks, -c) 0</span><br><span class="line">data seg size           (kbytes, -d) unlimited</span><br><span class="line">scheduling priority             (-e) 0</span><br><span class="line">file size               (blocks, -f) unlimited</span><br><span class="line">pending signals                 (-i) 3846</span><br><span class="line">max locked memory       (kbytes, -l) 64</span><br><span class="line">max memory size         (kbytes, -m) unlimited</span><br><span class="line">open files                      (-n) 1024</span><br><span class="line">pipe size            (512 bytes, -p) 8</span><br><span class="line">POSIX message queues     (bytes, -q) 819200</span><br><span class="line">real-time priority              (-r) 0</span><br><span class="line">stack size              (kbytes, -s) 8192</span><br><span class="line">cpu time               (seconds, -t) unlimited</span><br><span class="line">max user processes              (-u) 65525		   #已改变</span><br><span class="line">virtual memory          (kbytes, -v) unlimited</span><br><span class="line">file locks                      (-x) unlimited</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>检查登录用户打开文件数量的硬限制和软限制</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shashi@Ubuntu ~&#125;$ ulimit -Hn</span><br><span class="line">1048576</span><br><span class="line">shashi@Ubuntu ~&#125;$ ulimit -Sn</span><br><span class="line">1024</span><br></pre></td></tr></table></figure>

<ul>
<li>设置用户级资源限制</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hard <span class="built_in">limit</span> <span class="keyword">for</span> max opened files <span class="keyword">for</span> linuxtechi user</span></span><br><span class="line">linuxtechi       hard    nofile          4096</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">soft <span class="built_in">limit</span> <span class="keyword">for</span> max opened files <span class="keyword">for</span> linuxtechi user</span></span><br><span class="line">linuxtechi       soft    nofile          1024</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hard <span class="built_in">limit</span> <span class="keyword">for</span> max number of process <span class="keyword">for</span> oracle user</span></span><br><span class="line">oracle           hard    nproc          8096</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">soft <span class="built_in">limit</span> <span class="keyword">for</span> max number of process <span class="keyword">for</span> oracle user</span></span><br><span class="line">oracle           soft    nproc          4096</span><br></pre></td></tr></table></figure>

<ul>
<li>设置用户组级资源限制</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hard <span class="built_in">limit</span> <span class="keyword">for</span> max opened files <span class="keyword">for</span> sysadmin group</span></span><br><span class="line">@sysadmin        hard         nofile            4096 </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">soft <span class="built_in">limit</span> <span class="keyword">for</span> max opened files <span class="keyword">for</span> sysadmin group</span></span><br><span class="line">@sysadmin        soft         nofile            1024</span><br></pre></td></tr></table></figure>


<ul>
<li>切换用户并验证配置</li>
</ul>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">su - linuxtechi</span><br><span class="line"></span><br><span class="line">ulimit -n -H #打开文件最大限制数硬限制</span><br><span class="line">4096</span><br><span class="line"></span><br><span class="line">ulimit -n -S #打开文件最大限制数软限制</span><br><span class="line">1024</span><br><span class="line"></span><br><span class="line">su - oracle</span><br><span class="line"></span><br><span class="line">ulimit -H -u #最大线程数</span><br><span class="line">8096</span><br><span class="line"></span><br><span class="line">ulimit -S -u #最大线程数</span><br><span class="line">4096</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>使配置生效到配置用户</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># /etc/security/limits.conf</span><br><span class="line">#</span><br><span class="line">#Each line describes a limit for a user in the form:</span><br><span class="line">#</span><br><span class="line">#&lt;domain&gt;        &lt;type&gt;  &lt;item&gt;  &lt;value&gt;</span><br><span class="line">#</span><br><span class="line">#Where:</span><br><span class="line">#&lt;domain&gt; can be:</span><br><span class="line">#        - an user name</span><br><span class="line">#        - a group name, with @group syntax</span><br><span class="line">#        - the wildcard *, for default entry</span><br><span class="line">#        - the wildcard %, can be also used with %group syntax,</span><br><span class="line">#                 for maxlogin limit</span><br><span class="line">#</span><br><span class="line">#&lt;type&gt; can have the two values:</span><br><span class="line">#        - &quot;soft&quot; for enforcing the soft limits  软限制(soft limit) 设定资源的软限制。警告的设定，可以超过这个设定值，但是若超过则有警告信息</span><br><span class="line">#        - &quot;hard&quot; for enforcing hard limits      硬限制(hard limit) 设定资源的硬性限制，也就是管理员所设下的限制。严格的设定，必定不能超过这个设定的数值</span><br><span class="line">#</span><br><span class="line">#&lt;item&gt; can be one of the following:</span><br><span class="line">#        - core - limits the core file size (KB) core文件其实就是内存的映像，当程序崩溃时，存储内存的相应信息，主用用于对程序进行调试。当程序崩溃时便会产生core文件，其实准确的应该说是core dump 文件,默认生成位置与可执行程序位于同一目录下，文件名为core.***,其中***是某一数字。</span><br><span class="line">#        - data - max data size (KB)</span><br><span class="line">#        - fsize - maximum filesize (KB)  所能建立的最大文件，单位为区块。</span><br><span class="line">#        - memlock - max locked-in-memory address space (KB)</span><br><span class="line">#        - nofile - max number of open files  指定同一时间最多可开启的文件数。</span><br><span class="line">#        - rss - max resident set size (KB)</span><br><span class="line">#        - stack - max stack size (KB)</span><br><span class="line">#        - cpu - max CPU time (MIN)</span><br><span class="line">#        - nproc - max number of processes  程序孵出的最大子进程数量 </span><br><span class="line">#        - as - address space limit (KB)  地址空间限制  进程可用的内存的最大数量，包括堆栈、全局变量、动态内存</span><br><span class="line">#        - maxlogins - max number of logins for this user 此用户允许登录的最大数目</span><br><span class="line">#        - maxsyslogins - max number of logins on the system 系统最大同时在线用户数</span><br><span class="line">#        - priority - the priority to run user process with 运行用户进程的优先级</span><br><span class="line">#        - locks - max number of file locks the user can hold 用户可以持有的文件锁的最大数量</span><br><span class="line">#        - sigpending - max number of pending signals</span><br><span class="line">#        - msgqueue - max memory used by POSIX message queues (bytes)</span><br><span class="line">#        - nice - max nice priority allowed to raise to values: [-20, 19]</span><br><span class="line">#        - rtprio - max realtime priority</span><br><span class="line">#</span><br><span class="line">#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/14/linux/limit/" data-id="clpfb6uhk001ptoqw7mpq783a" data-title="Linux limit" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-java/tomcat/tomcat_die" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/13/java/tomcat/tomcat_die/" class="article-date">
  <time class="dt-published" datetime="2022-07-13T02:00:34.000Z" itemprop="datePublished">2022-07-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tc/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/13/java/tomcat/tomcat_die/">一次tomcat假死问题排查</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#Tomcat 假死问题排查思路</p>
<h3 id="Jvm内存问题及线程问题排查"><a href="#Jvm内存问题及线程问题排查" class="headerlink" title="Jvm内存问题及线程问题排查"></a>Jvm内存问题及线程问题排查</h3><ol>
<li>JVM内存使用情况查看 </li>
</ol>
<blockquote>
<p>jmap -heap pid</p>
</blockquote>
<blockquote>
<p>jmap -dump:live,format=b,file=/home/xxxx.hprof pid</p>
</blockquote>
<blockquote>
<p>jmap -histo:live 27151</p>
</blockquote>
<blockquote>
<p>jmap -histo 18230 | sort -n -r -k 2 | head -10  //统计实例最多的类 前十位有哪些</p>
</blockquote>
<blockquote>
<p>jmap -histo 18230 | sort -n -r -k 3 | head -10  //统计合计容量前十的类有哪些  </p>
</blockquote>
<blockquote>
<p>jstat -gcutil pid 1000 3 //监控gc 状态</p>
</blockquote>
<blockquote>
<p>jinfo -flags pid // 查看tomcatJVM配置参数</p>
</blockquote>
<ol start="2">
<li>线程栈问题提取 检查是否有锁问题</li>
</ol>
<blockquote>
<p>./jstack pid |grep http-nio-8090-exec （请求处理线程，可以检查处理线程卡在了哪里）<br>./jstack -l pid</p>
<blockquote>
<p>打印关于锁的其他信息，比如拥有的java.util.concurrent ownable同步器的列表。</p>
</blockquote>
</blockquote>
<blockquote>
<p>jstack -F pid</p>
<blockquote>
<p>当 jstack [-l] pid 没有响应时，强制打印一个堆栈转储。</p>
</blockquote>
</blockquote>
<ol start="3">
<li>查看tomcat进程内线程</li>
</ol>
<blockquote>
<p>ps -Lf –pid 16139 |wc -l</p>
<blockquote>
<p> 统计该tomcat进程内的线程个数 </p>
</blockquote>
</blockquote>
<blockquote>
<p>pstree -p 16139 |wc -l</p>
<blockquote>
<p>统计该tomcat进程内的线程个数 </p>
</blockquote>
</blockquote>
<ol start="4">
<li>查看进程打开的TCP链接的连接数</li>
</ol>
<blockquote>
<p>netstat -anpt|grep pid  -c</p>
</blockquote>
<ol start="5">
<li>查看端口的TCP连接数</li>
</ol>
<blockquote>
<p>  netstat -anpt|grep port -c</p>
</blockquote>
<h3 id="Tomcat相关配置"><a href="#Tomcat相关配置" class="headerlink" title="Tomcat相关配置"></a>Tomcat相关配置</h3><ol>
<li>catalina.sh 相关配置</li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">JAVA_OPTS</span>=<span class="string">&quot;-server </span></span><br><span class="line"><span class="attr">-Dfile.encoding</span>=<span class="string">UTF-8 </span></span><br><span class="line"><span class="attr">-Xms2048m</span> <span class="string"></span></span><br><span class="line"><span class="attr">-Xmx2048m</span></span><br><span class="line"><span class="attr">-Xloggc</span>:<span class="string">/home/tomcat/images/gclogs/cms-gc-150.log</span></span><br><span class="line"><span class="attr">-verbose</span>:<span class="string">gc -XX:+PrintGCDetails</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">+PrintGCDateStamps</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">+UseGCLogFileRotation</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">+PrintGCApplicationStoppedTime</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">NumberOfGCLogFiles=10</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">GCLogFileSize=100M</span></span><br><span class="line"><span class="attr">-Dlog4j2.formatMsgNoLookups</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">+UseConcMarkSweepGC</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">CMSInitiatingOccupancyFraction=75</span></span><br><span class="line"><span class="attr">-XX</span>:<span class="string">+UseCMSInitiatingOccupancyOnly</span></span><br><span class="line"><span class="attr">&quot;</span></span><br></pre></td></tr></table></figure>


<ol start="2">
<li>垃圾回收器</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-XX:+UseConcMarkSweepGC</span><br><span class="line">-XX:CMSInitiatingOccupancyFraction=<span class="number">75</span></span><br><span class="line">-XX:+UseCMSInitiatingOccupancyOnly </span><br></pre></td></tr></table></figure>

<p>-XX:+UseConcMarkSweepGC<br>表示年轻代使用 ParNew，老年代的用 CMS 垃圾回收器</p>
<p>-XX:CMSInitiatingOccupancyFraction=75 </p>
<p>由于 CMS 在执行过程中，用户线程还需要运行，那就需要保证有充足的内存空间供用户使用。<br>如果等到老年代空间快满了，再开启这个回收过程，用户线程可能会产生“Concurrent Mode Failure”的错误，这时会临时启用 Serial Old 收集器来重新进行老年代的垃圾收集，<br>这样停顿时间就很长了（STW）。这部分空间预留，一般在 30% 左右即可，那么能用的大概只有 70%。参数 -XX:CMSInitiatingOccupancyFraction 用来配置这个比例，但它首先必须配置 -XX:+UseCMSInitiatingOccupancyOnly 参数。</p>
<p>-XX:+UseCMSInitiatingOccupancyOnly</p>
<ol start="3">
<li>TomcatConnector</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html#Introduction">官网介绍</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">&quot;8081&quot;</span> </span></span><br><span class="line"><span class="tag">               <span class="attr">protocol</span>=<span class="string">&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">keepAliveTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">acceptorThreadCount</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">maxThreads</span>=<span class="string">&quot;360&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">maxConnections</span>=<span class="string">&quot;1000&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">acceptCount</span>=<span class="string">&quot;200&quot;</span>       </span></span><br><span class="line"><span class="tag">               <span class="attr">redirectPort</span>=<span class="string">&quot;8445&quot;</span> </span></span><br><span class="line"><span class="tag">               <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
 <Connector port="8081" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8445" URIEncoding="UTF-8" />
</blockquote>
<ul>
<li> protocol：</li>
</ul>
<p><em>一：BIO org.apache.coyote.http11.Http11Protocol - blocking Java connector</em> <br/><br><br/><br>一个线程处理一个请求。缺点：并发量高时，线程数较多，浪费资源。<br/><br>Tomcat7或以下，在Linux系统中默认使用这种方式。</p>
<p><em>二：NIO  org.apache.coyote.http11.Http11NioProtocol - non blocking Java connector</em><br/><br><br/><br>利用Java的异步IO处理，可以通过少量的线程处理大量的请求。<br/><br>Tomcat8在Linux系统中默认使用这种方式。<br/><br>Tomcat7必须修改Connector配置来启动：<br/><br><Connector port="8080" protocol="org.apache.coyote.http11.Http11NioProtocol" connectionTimeout="20000" redirectPort="8443"/> </p>
<p><em>三：APR org.apache.coyote.http11.Http11AprProtocol - the APR/native connector.</em><br/><br><br/><br>即Apache Portable Runtime，从操作系统层面解决io阻塞问题。<br/><br>Tomcat7或Tomcat8在Win7或以上的系统中启动默认使用这种方式。<br/><br>Linux如果安装了apr和native，Tomcat直接启动就支持apr。（安装方法：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/nb-blog/p/5278502.html%EF%BC%89">http://www.cnblogs.com/nb-blog/p/5278502.html）</a></p>
<ul>
<li><p>URIEncoding：<br/><br>This specifies the character encoding used to decode the URI bytes, after %xx decoding the URL. If not specified, ISO-8859-1 will be used.</p>
</li>
<li><p>acceptorThreadCount：<br/><br>用于接受连接的线程数。在多CPU的机器上增加这个值，虽然你永远不会真的需要超过2。此外，对于许多非保持活动状态的连接，您可能也想增加该值。默认值为1。</p>
</li>
</ul>
<ul>
<li><p>connectionLinger<br/><br>此连接器使用的套接字在关闭时停留的秒数。默认值为-1，表示禁用套接字逗留</p>
</li>
<li><p>connectionUploadTimeout<br/><br>指定数据上载过程中使用的超时时间(以毫秒为单位)。这仅在disableUploadTimeout设置为false时生效</p>
</li>
<li><p>disableUploadTimeout<br/><br>该标志允许servlet容器在数据上传期间使用不同的、通常更长的连接超时。如果未指定，此属性将设置为true，从而禁用更长的超时</p>
</li>
<li><p>keepAliveTimeout<br/><br>此连接器在关闭连接之前等待另一个HTTP请求的毫秒数。默认值是使用为connectionTimeout属性设置的值。使用值-1表示没有(即无限)超时</p>
</li>
<li><p>maxConnections<br/><br>服务器在任何给定时间接受和处理的最大连接数。当达到这个数目时，服务器将接受，但不处理，一个进一步的连接。这个额外的连接将被阻塞，直到被处理的连接数低于最大连接数，<br>此时服务器将再次开始接受和处理新的连接。请注意，一旦达到限制，操作系统可能仍然会根据acceptCount设置接受连接。默认值因连接器类型而异。<br>对于BIO，默认值是maxThreads的值，除非使用了执行器，在这种情况下，默认值将是来自执行器的maxThreads的值。对于NIO，默认值为10000。对于APR/native，默认值为8192。<br>仅对于NIO，将该值设置为-1将禁用maxConnections功能，并且不会计算连接数。</p>
</li>
<li><p>maxThreads<br/><br>此连接器要创建的最大请求处理线程数，因此决定了可以处理的最大并发请求数。如果未指定，该属性将设置为200。如果一个执行器与这个连接器相关联，那么这个属性将被忽略，<br>因为连接器将使用执行器而不是内部线程池来执行任务。<br>注意，如果配置了executor，为该属性设置的任何值都将被正确记录，但它将被报告(例如通过JMX)为-1，以表明它未被使用。</p>
</li>
<li><p>acceptCount<br/><br>当所有可能的请求处理线程都在使用中时，传入连接请求的最大队列长度。队列已满时收到的任何请求都将被拒绝。默认值为100</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/13/java/tomcat/tomcat_die/" data-id="clpfb6ui00043toqw2z8d3v8z" data-title="一次tomcat假死问题排查" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-softwareeng/软件开发方法学" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/05/softwareeng/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95%E5%AD%A6/" class="article-date">
  <time class="dt-published" datetime="2022-06-05T12:25:49.000Z" itemprop="datePublished">2022-06-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/">软件工程</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/06/05/softwareeng/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95%E5%AD%A6/">软件开发方法学</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>(1)生命周期法。软件开发严格按系统调查与分析、系统设计、系统实现、系统调试、运行维护和废弃等阶段进行。这种方法要求系统说明书应准确地表达用户的要求，并且在以后阶段不会发生变化。<br>　　<br>生命周期法采用结构化系统分析与设计的思想，其突出优点是强调系统开发过程的整体性和全局性，避免了开发过程中的混乱状态。其主要缺陷是开发周期长，工作效率低，难以适应新型开发工具的发展，但其基本思想在其他开发方法仍然适用。<br>　　<br>(2)原型法。开发人员首先构造系统初步模型，运行这个模型并根据用户的要求不断修改、补充，直到取得一个用户完全满意的原型为止，最后实现系统。  </p>
<p>原型法的主要优点是开发周期短、见效快，可以边开发边使用，比较适合于管理体制和结构不稳定，需要经常变化的环境。其缺点是初始原型设计比较困难，容易陷入软件危机，对于大型复杂的应用系统一般不宜采用。<br>　　<br>(3)面向对象法。简称OO，其基本思想是：客观事物都是由对象组成的，对象具有属性和方法，属性反映对象的特征，方法则是改变属性的各种动作；对象之间的联系主要通过传递消息来实现；对象可以按属性归为类，类有一定的结构，而且可以有子类，对象与类之间的层次关系是通过继承来维持的。<br>　　<br>按照上述思想，OO方法分为四个阶段：系统调查和需求分析，解决系统干什么；面向对象分析，识别出对象及其行为、结构、属性和方法，简称OOA；面向对象设计，对分析结果进一步抽象、归类和整理，最终以范式的形式确定下来，简称OOD；面向对象编程，利用面向对象程序设计语言编制应用程序，简称OOP。  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/05/softwareeng/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95%E5%AD%A6/" data-id="clpfb6uho0026toqw7ib87qz6" data-title="软件开发方法学" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95/" rel="tag">开发方法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tool/opensslcommon" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/30/tool/opensslcommon/" class="article-date">
  <time class="dt-published" datetime="2022-05-30T06:01:59.000Z" itemprop="datePublished">2022-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/05/30/tool/opensslcommon/">OpenSSL命令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>查看ca证书的内容<br>openssl x509 -in ca.crt -noout -text</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/05/30/tool/opensslcommon/" data-id="clpfb6uht002ytoqw7sq5h7wj" data-title="OpenSSL命令" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openssl/" rel="tag">openssl</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tool/opensslzqm" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/30/tool/opensslzqm/" class="article-date">
  <time class="dt-published" datetime="2022-05-30T05:36:38.000Z" itemprop="datePublished">2022-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/05/30/tool/opensslzqm/">自签名证书</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Centos7-环境下生成自签名SSL证书的具体过程："><a href="#Centos7-环境下生成自签名SSL证书的具体过程：" class="headerlink" title="Centos7 环境下生成自签名SSL证书的具体过程："></a>Centos7 环境下生成自签名SSL证书的具体过程：</h1><ol>
<li><p>修改 openssl 配置文件<br>vi /etc/pki/tls/openssl.cnf<br>match 表示后续生成的子证书的对应项必须和创建根证书时填的值一样，否则报错。以下配置只规定子证书的 countryName 必须和根证书一致。<br>[policy_match] 段配置改成如下：<br>countryName = match<br>stateOrProvinceName = optional<br>organizationName = optional<br>organizationalUnitName = optional<br>commonName = supplied<br>emailAddress = optional</p>
</li>
<li><p>在服务器 pki 的 CA 目录下新建两个文件<br>cd /etc/pki/CA &amp;&amp; touch index.txt serial &amp;&amp; echo 01 &gt; serial</p>
</li>
<li><p>生成CA根证书密钥<br>cd /etc/pki/CA/ &amp;&amp; openssl genrsa -out private/cakey.pem 2048 &amp;&amp; chmod 400 private/cakey.pem</p>
</li>
<li><p>生成根证书（根据提示输入信息，除了 Country Name 选项需要记住的，后面的随便填）<br>openssl req -new -x509 -key private/cakey.pem -out cacert.pem</p>
</li>
<li><p>生成密钥文件<br>openssl genrsa -out nginx.key 2048</p>
</li>
<li><p>生成证书请求文件（CSR）:<br>A.根据提示输入信息，除了 Country Name 与前面根证书一致外，其他随便填写<br>B.Common Name 填写要保护的域名，比如：*.qhh.me<br>openssl req -new -key nginx.key -out nginx.csr</p>
</li>
<li><p>使用 openssl 签署 CSR 请求，生成证书<br>openssl ca -in nginx.csr -cert /etc/pki/CA/cacert.pem -keyfile /etc/pki/CA/private/cakey.pem -days 365 -out nginx.crt</p>
</li>
</ol>
<blockquote>
<p>参数项说明：</p>
</blockquote>
<ol>
<li>-in: CSR 请求文件</li>
<li>-cert: 用于签发的根 CA 证书</li>
<li>-keyfile: 根 CA 的私钥文件</li>
<li>-days: 生成的证书的有效天数</li>
<li>-out: 生成证书的文件名</li>
</ol>
<p>至此自签名证书生成完成，最终需要：nginx.key 和 nginx.crt<br>8. 配置Nginx使用自签名证书</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen  80;</span><br><span class="line">  server_name     domain;</span><br><span class="line">  return  301     https://$host$request_uri;  # 表示强制将http请求重定向到https端口</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen  443 ssl;</span><br><span class="line">    ssl_certificate       ssl/nginx.crt; # 前面生成的 crt 证书文件</span><br><span class="line">    ssl_certificate_key   ssl/nginx.key; # 前面生成的证书私钥</span><br><span class="line">    server_name     domain;</span><br><span class="line">    location / &#123;</span><br><span class="line">    root /var/www-html;</span><br><span class="line">    index  index.html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/05/30/tool/opensslzqm/" data-id="clpfb6uht0032toqwd5zofn6s" data-title="自签名证书" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openssl/" rel="tag">openssl</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DB/">DB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringCloud/">SpringCloud</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tc/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%9F%A5%E8%AF%86/">知识</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD/">系统性能</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/">软件工程</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DDD/" rel="tag">DDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design/" rel="tag">Design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES/" rel="tag">ES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Seata/" rel="tag">Seata</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" rel="tag">SpringCloud负载均衡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activity/" rel="tag">activity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/arthas/" rel="tag">arthas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openssl/" rel="tag">openssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/" rel="tag">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/questions/" rel="tag">questions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springmvc/" rel="tag">springmvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uml/" rel="tag">uml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95/" rel="tag">开发方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%87%E5%87%86/" rel="tag">标准</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%96%AF%E4%BC%A0/" rel="tag">疯传</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" rel="tag">负载均衡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%87%E7%A8%8B%E6%A8%A1%E5%9E%8B/" rel="tag">过程模型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/" rel="tag">项目管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6/" rel="tag">项目管理相关文件</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/DDD/" style="font-size: 10px;">DDD</a> <a href="/tags/Design/" style="font-size: 12.5px;">Design</a> <a href="/tags/Docker/" style="font-size: 12.5px;">Docker</a> <a href="/tags/ES/" style="font-size: 15px;">ES</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Seata/" style="font-size: 12.5px;">Seata</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/SpringCloud%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 10px;">SpringCloud负载均衡</a> <a href="/tags/activity/" style="font-size: 12.5px;">activity</a> <a href="/tags/arthas/" style="font-size: 10px;">arthas</a> <a href="/tags/java/" style="font-size: 12.5px;">java</a> <a href="/tags/jvm/" style="font-size: 20px;">jvm</a> <a href="/tags/linux/" style="font-size: 12.5px;">linux</a> <a href="/tags/openssl/" style="font-size: 12.5px;">openssl</a> <a href="/tags/oracle/" style="font-size: 10px;">oracle</a> <a href="/tags/questions/" style="font-size: 10px;">questions</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/spring/" style="font-size: 17.5px;">spring</a> <a href="/tags/springmvc/" style="font-size: 17.5px;">springmvc</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/uml/" style="font-size: 10px;">uml</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95/" style="font-size: 10px;">开发方法</a> <a href="/tags/%E6%A0%87%E5%87%86/" style="font-size: 10px;">标准</a> <a href="/tags/%E7%96%AF%E4%BC%A0/" style="font-size: 10px;">疯传</a> <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 10px;">负载均衡</a> <a href="/tags/%E8%BF%87%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 10px;">过程模型</a> <a href="/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/" style="font-size: 12.5px;">项目管理</a> <a href="/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6/" style="font-size: 10px;">项目管理相关文件</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/11/26/softwareeng/DDD/">保持模型的完整性</a>
          </li>
        
          <li>
            <a href="/2023/11/25/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95%E4%B9%8BRUP/">软件过程模型之RUP</a>
          </li>
        
          <li>
            <a href="/2022/08/31/db/oracl/sqlanalysi/">ORACLE sql 分析</a>
          </li>
        
          <li>
            <a href="/2022/08/26/java/arthas/">vmtoll</a>
          </li>
        
          <li>
            <a href="/2022/07/26/db/mysql/">Mysql数据类型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 晓<br>
      Powered by <a href="https://hexo.io/" target="_blank">晓</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about/me" class="mobile-nav-link">关于</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>